<html lang="zh-CN"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPT Team å…‘æ¢ Â· æ–°æ˜¥ç‰¹åˆ«ç‰ˆ</title>
    <style>
/* ç”¨æˆ·å…‘æ¢é¡µé¢æ ·å¼ */

@import url('https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@400;500;600;700;900&display=swap');

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

:root {
    --primary: #6366f1;
    --primary-hover: #4f46e5;
    --primary-glow: rgba(99, 102, 241, 0.4);

    --bg-main: #0b0f1a;
    --bg-surface: #13192b;
    --bg-glass: rgba(255, 255, 255, 0.03);
    --bg-glass-heavy: rgba(15, 23, 42, 0.85);

    --text-main: #f8fafc;
    --text-dim: #94a3b8;
    --text-muted: #64748b;

    --border-glass: rgba(255, 255, 255, 0.08);
    --border-highlight: rgba(255, 255, 255, 0.15);

    --success: #10b981;
    --danger: #ef4444;

    --shadow-lg: 0 10px 25px -5px rgba(0, 0, 0, 0.5), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    --shadow-glow: 0 0 20px rgba(99, 102, 241, 0.15);

    --radius-md: 10px;
    --radius-lg: 16px;
    --radius-full: 9999px;
}

body {
    font-family: 'Outfit', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: var(--bg-main);
    background-image:
        radial-gradient(at 0% 0%, rgba(99, 102, 241, 0.15) 0px, transparent 50%),
        radial-gradient(at 100% 100%, rgba(168, 85, 247, 0.1) 0px, transparent 50%);
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    color: var(--text-main);
}

.container {
    max-width: 600px;
    width: 100%;
}

.header {
    text-align: center;
    margin-bottom: 2rem;
    color: white;
}

.header h1 {
    font-size: 2.5rem;
    margin-bottom: 0.5rem;
    font-weight: 700;
}

.subtitle {
    font-size: 1.1rem;
    opacity: 0.9;
}

.step {
    display: none;
}

.step.active {
    display: block;
    animation: fadeIn 0.3s ease-in;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.card {
    background-color: var(--bg-glass-heavy);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    border: 1px solid var(--border-highlight);
    border-radius: var(--radius-lg);
    padding: 2.5rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
}

.card h2 {
    font-size: 1.6rem;
    font-weight: 700;
    margin-bottom: 1rem;
}

.step-desc {
    color: var(--text-dim);
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
}

.form-group label {
    display: block;
    font-size: 0.9rem;
    font-weight: 500;
    margin-bottom: 0.5rem;
    color: var(--text-dim);
}

.form-input {
    width: 100%;
    padding: 0.8rem 1rem;
    background-color: rgba(0, 0, 0, 0.2);
    border: 1px solid var(--border-glass);
    border-radius: var(--radius-md);
    color: var(--text-main);
    font-size: 1rem;
    transition: all 0.3s ease;
}

.form-input:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 3px var(--primary-glow);
    background-color: rgba(0, 0, 0, 0.3);
}

.btn {
    padding: 0.8rem 1.5rem;
    border: none;
    border-radius: var(--radius-md);
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary), #a855f7);
    color: white;
    width: 100%;
    box-shadow: 0 4px 15px var(--primary-glow);
}

.btn-primary:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px var(--primary-glow);
    filter: brightness(1.1);
}

.btn-secondary {
    background-color: rgba(255, 255, 255, 0.05);
    border: 1px solid var(--border-glass);
    color: var(--text-main);
}

.btn-secondary:hover:not(:disabled) {
    background-color: rgba(255, 255, 255, 0.1);
}

.teams-list {
    display: grid;
    gap: 1rem;
    margin-bottom: 1.5rem;
}

.team-card {
    background-color: var(--bg-glass);
    border: 1px solid var(--border-glass);
    border-radius: var(--radius-md);
    padding: 1.25rem;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.team-card:hover {
    background-color: rgba(255, 255, 255, 0.05);
    border-color: var(--primary);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.1);
}

.team-card.selected {
    background-color: rgba(99, 102, 241, 0.1);
    border-color: var(--primary);
    box-shadow: 0 0 0 1px var(--primary);
}

.team-name {
    font-size: 1.15rem;
    font-weight: 700;
    margin-bottom: 0.75rem;
    color: var(--text-main);
}

.team-info {
    display: flex;
    gap: 1.25rem;
    flex-wrap: wrap;
    font-size: 0.85rem;
    color: var(--text-dim);
}

.team-info-item {
    display: flex;
    align-items: center;
    gap: 0.35rem;
}

.team-badge {
    display: inline-block;
    padding: 0.2rem 0.6rem;
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.02em;
}

.badge-plus {
    background: rgba(99, 102, 241, 0.15);
    color: #818cf8;
}

.badge-pro {
    background: rgba(168, 85, 247, 0.15);
    color: #c084fc;
}

.actions {
    display: flex;
    gap: 1rem;
}

.actions .btn {
    flex: 1;
}

.result-success {
    text-align: center;
    padding: 2rem 0;
}

.result-icon {
    font-size: 4rem;
    margin-bottom: 1rem;
}

.result-success .result-icon.success-check-animate {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    transform-origin: center;
    min-height: 118px;
}

.result-success .result-icon.success-check-animate.is-animated {
    animation: successCheckPop 700ms cubic-bezier(0.16, 1, 0.3, 1) both;
}

.result-success .result-icon.success-check-animate svg {
    overflow: visible;
}

.success-halo {
    position: absolute;
    width: 122px;
    height: 122px;
    border-radius: 50%;
    border: 2px solid rgba(23, 130, 82, 0.26);
    box-shadow: 0 0 0 0 rgba(23, 130, 82, 0.22);
    opacity: 0;
    transform: scale(0.82);
}

.success-halo.is-animated {
    animation: successHaloPulse 860ms ease-out both;
}

.success-checkmark {
    width: 106px;
    height: 106px;
    filter: drop-shadow(0 10px 18px rgba(21, 115, 71, 0.2));
}

.success-circle-path {
    fill: rgba(23, 130, 82, 0.06);
    stroke: #178252;
    stroke-width: 4.4;
}

.success-check-path {
    fill: none;
    stroke: #178252;
    stroke-width: 6;
    stroke-linecap: round;
    stroke-linejoin: round;
}

.result-title {
    font-size: 1.8rem;
    font-weight: 800;
    color: var(--text-main);
    margin-bottom: 0.5rem;
}

.result-blessing {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 0.95rem;
    padding: 0.28rem 0.9rem;
    border-radius: 999px;
    border: 1px solid rgba(188, 31, 31, 0.26);
    background: linear-gradient(180deg, rgba(255, 231, 186, 0.45), rgba(255, 231, 186, 0.12));
    color: #a11616;
    font-size: 0.98rem;
    font-weight: 700;
    letter-spacing: 0.03em;
    animation: blessingFadeIn 420ms ease both;
}

@keyframes successCheckPop {
    0% {
        opacity: 0;
        transform: scale(0.6) rotate(-13deg);
    }

    64% {
        opacity: 1;
        transform: scale(1.18) rotate(3deg);
    }

    100% {
        opacity: 1;
        transform: scale(1) rotate(0deg);
    }
}

@keyframes successHaloPulse {
    0% {
        opacity: 0.62;
        transform: scale(0.72);
        box-shadow: 0 0 0 0 rgba(23, 130, 82, 0.22);
    }

    100% {
        opacity: 0;
        transform: scale(1.22);
        box-shadow: 0 0 0 14px rgba(23, 130, 82, 0);
    }
}

@keyframes blessingFadeIn {
    from {
        opacity: 0;
        transform: translateY(8px) scale(0.96);
    }

    to {
        opacity: 1;
        transform: translateY(0) scale(1);
    }
}

.result-message {
    font-size: 1rem;
    color: var(--text-dim);
    margin-bottom: 2rem;
}

.result-details {
    background-color: rgba(0, 0, 0, 0.2);
    border: 1px solid var(--border-glass);
    border-radius: var(--radius-md);
    padding: 1.5rem;
    margin-bottom: 2rem;
    text-align: left;
}

.result-detail-item {
    display: flex;
    justify-content: space-between;
    padding: 0.8rem 0;
    border-bottom: 1px solid var(--border-glass);
}

.result-detail-item:last-child {
    border-bottom: none;
}

.result-detail-label {
    color: var(--text-muted);
    font-size: 0.9rem;
}

.result-detail-value {
    color: var(--text-main);
    font-weight: 600;
}

.result-error {
    text-align: center;
    padding: 2rem 0;
}

.result-error .result-icon {
    color: var(--danger-color);
}

.result-error .result-title {
    color: var(--danger-color);
}

/* Toastæç¤º */
.toast {
    position: fixed;
    top: 2rem;
    right: 2rem;
    padding: 1rem 1.5rem;
    border-radius: 8px;
    box-shadow: var(--shadow-lg);
    display: none;
    z-index: 1000;
    animation: slideIn 0.3s ease-out;
}

.toast.show {
    display: block;
}

.toast.success {
    background-color: var(--success-color);
    color: white;
}

.toast.error {
    background-color: var(--danger-color);
    color: white;
}

.toast.info {
    background-color: var(--primary-color);
    color: white;
}

@keyframes slideIn {
    from {
        transform: translateX(100%);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 768px) {
    body {
        padding: 1rem;
    }

    .header h1 {
        font-size: 2rem;
    }

    .card {
        padding: 1.5rem;
    }

    .actions {
        flex-direction: column;
    }
}

/* ===== New Year Theme Override ===== */
:root {
    --primary: #bc1f1f;
    --primary-hover: #9f1818;
    --primary-glow: rgba(188, 31, 31, 0.34);
    --primary-light: #f9d372;

    --bg-main: #fdf6e7;
    --bg-surface: #fffaf0;
    --bg-glass: rgba(255, 251, 245, 0.72);
    --bg-glass-heavy: rgba(255, 251, 241, 0.92);

    --text-main: #311a13;
    --text-dim: #614130;
    --text-muted: #8a6a53;

    --border-glass: rgba(188, 31, 31, 0.16);
    --border-highlight: rgba(188, 31, 31, 0.28);

    --success: #157347;
    --danger: #b42318;
    --danger-color: #b42318;
    --success-color: #157347;
    --primary-color: #bc1f1f;

    --shadow-lg: 0 16px 34px rgba(75, 36, 19, 0.14);
    --shadow-glow: 0 0 0 1px rgba(244, 180, 61, 0.2), 0 8px 24px rgba(188, 31, 31, 0.14);
}

body {
    font-family: 'Noto Serif SC', 'Songti SC', 'STSong', 'SimSun', serif;
    background:
        radial-gradient(circle at 12% 14%, rgba(244, 180, 61, 0.28), transparent 34%),
        radial-gradient(circle at 85% 8%, rgba(188, 31, 31, 0.14), transparent 34%),
        repeating-linear-gradient(145deg, rgba(240, 199, 118, 0.11) 0 2px, rgba(253, 246, 231, 0) 2px 8px),
        linear-gradient(180deg, #fff8ea 0%, #f7e8ce 42%, #fff6e4 100%);
    color: var(--text-main);
    overflow-x: hidden;
}

.festival-frame {
    position: fixed;
    inset: 14px;
    border: 2px solid rgba(198, 38, 38, 0.24);
    border-radius: 20px;
    pointer-events: none;
    z-index: 2;
    box-shadow:
        inset 0 0 0 1px rgba(248, 208, 120, 0.46),
        inset 0 0 28px rgba(198, 38, 38, 0.08);
}

.festival-frame::before,
.festival-frame::after {
    content: "";
    position: absolute;
    width: 68px;
    height: 68px;
    border: 3px solid rgba(242, 188, 73, 0.86);
    border-radius: 16px;
    opacity: 0.75;
}

.festival-frame::before {
    top: 8px;
    left: 8px;
    border-right: none;
    border-bottom: none;
}

.festival-frame::after {
    right: 8px;
    bottom: 8px;
    border-left: none;
    border-top: none;
}

.festival-couplets {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 3;
}

/* å¯¹è”ç¿»è½¬å®¹å™¨ */
.couplet-wrapper {
    position: absolute;
    top: 200px;
    width: 62px;
    height: 380px;
    perspective: 800px;
}

.couplet-wrapper.couplet-left {
    left: 18px;
}

.couplet-wrapper.couplet-right {
    right: 18px;
}

.couplet-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.8s ease-in-out;
}

.couplet-wrapper.flipped .couplet-inner {
    transform: rotateY(180deg);
}

.couplet {
    position: absolute;
    inset: 0;
    border-radius: 16px;
    border: 2px solid rgba(246, 199, 84, 0.86);
    background:
        linear-gradient(180deg, rgba(255, 227, 154, 0.16), rgba(255, 227, 154, 0)),
        linear-gradient(180deg, #cb2828, #9d1616 68%, #861010);
    box-shadow: 0 14px 24px rgba(118, 18, 18, 0.22);
    color: #ffe29b;
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: 2rem;
    writing-mode: vertical-rl;
    text-orientation: upright;
    letter-spacing: 0.1em;
    line-height: 1;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    text-shadow: 0 1px 0 rgba(124, 73, 6, 0.8), 0 2px 8px rgba(255, 204, 104, 0.35);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

.couplet-back {
    transform: rotateY(180deg);
}

/* æ¨ªæ‰¹ç¿»è½¬å®¹å™¨ */
.crossbeam-wrapper {
    position: absolute;
    top: 26px;
    left: 50%;
    transform: translateX(-50%);
    min-width: 190px;
    height: 48px;
    perspective: 600px;
}

.crossbeam-inner {
    position: relative;
    width: 100%;
    height: 100%;
    transform-style: preserve-3d;
    transition: transform 0.8s ease-in-out;
}

.crossbeam-wrapper.flipped .crossbeam-inner {
    transform: rotateX(180deg);
}

.couplet-crossbeam {
    position: absolute;
    inset: 0;
    border-radius: 12px;
    border: 2px solid rgba(246, 199, 84, 0.88);
    background: linear-gradient(180deg, #cf2a2a, #941515);
    color: #ffe29c;
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: 1.6rem;
    letter-spacing: 0.08em;
    display: flex;
    align-items: center;
    justify-content: center;
    text-shadow: 0 1px 0 rgba(121, 72, 7, 0.84), 0 3px 9px rgba(255, 206, 99, 0.36);
    box-shadow: 0 10px 20px rgba(118, 18, 18, 0.24);
    backface-visibility: hidden;
    -webkit-backface-visibility: hidden;
}

.crossbeam-back {
    transform: rotateX(180deg);
}

.page-lanterns {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 4;
    contain: layout style;
}

/* ===== çœŸå®ç¯ç¬¼ ===== */
.lantern {
    position: absolute;
    top: 30px;
    width: 110px;
    transform-origin: top center;
    will-change: transform;
}

.lantern-left {
    left: 28px;
    animation: lanternSwing 5s ease-in-out infinite;
}

.lantern-right {
    right: 28px;
    animation: lanternSwing 5.4s ease-in-out infinite reverse;
}

/* æ‚¬æŒ‚ç»³ */
.lantern-line {
    position: absolute;
    top: -40px;
    left: 50%;
    width: 2px;
    height: 42px;
    transform: translateX(-50%);
    background: linear-gradient(180deg, #a67c28, #8b6914);
    border-radius: 2px;
}

.lantern-line::after {
    content: "";
    position: absolute;
    bottom: -4px;
    left: 50%;
    transform: translateX(-50%);
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: radial-gradient(circle at 38% 36%, #ffe6a0, #c9922a);
}

/* é‡‘å±ç¯ */
.lantern-ring {
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    width: 72px;
    height: 16px;
    border-radius: 8px;
    background: linear-gradient(180deg, #fbe5a0 0%, #d4a62e 30%, #b8892a 60%, #dbb84e 100%);
    border: 1px solid rgba(160, 110, 20, 0.7);
    box-shadow: 0 2px 4px rgba(100, 60, 10, 0.3);
    z-index: 3;
}

.lantern-ring-top {
    top: -2px;
}

.lantern-ring-bottom {
    bottom: -2px;
}

/* ç¯ç¬¼ä¸»ä½“ â€” æ¤­åœ†å½¢ï¼Œæœ‰éª¨æ¶å’Œå†…å…‰ */
.lantern-body {
    position: relative;
    width: 110px;
    height: 150px;
    border-radius: 55px / 75px;
    overflow: hidden;
    /* å¤šå±‚æ¸å˜ï¼šåº•è‰² + ç«–å‘éª¨æ¶ + é¡¶éƒ¨é«˜å…‰ */
    background:
        /* é¡¶éƒ¨é«˜å…‰ */
        radial-gradient(ellipse 80% 40% at 50% 18%, rgba(255, 230, 160, 0.5) 0%, transparent 70%),
        /* ç«–å‘éª¨æ¶ï¼ˆè‚‹æ¡ï¼‰ */
        repeating-conic-gradient(
            from 0deg at 50% 50%,
            rgba(180, 40, 20, 0.08) 0deg 8deg,
            transparent 8deg 30deg
        ),
        /* ä¸»ä½“çº¢è‰²æ¸å˜ */
        radial-gradient(ellipse 100% 100% at 50% 45%, #e83a2a 0%, #c42020 40%, #9a1515 80%, #7a1010 100%);
    border: 2px solid rgba(220, 170, 60, 0.75);
    box-shadow:
        inset 0 0 30px rgba(255, 200, 80, 0.25),
        inset 0 -15px 30px rgba(120, 10, 10, 0.3),
        0 8px 20px rgba(120, 20, 20, 0.25);
}

/* å†…éƒ¨å‘å…‰å±‚ */
.lantern-glow {
    position: absolute;
    inset: 15%;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 220, 120, 0.35) 0%, rgba(255, 180, 60, 0.12) 40%, transparent 70%);
    animation: lanternGlow 3s ease-in-out infinite alternate;
}

@keyframes lanternGlow {
    0% { opacity: 0.6; }
    100% { opacity: 1; }
}

/* ç¯ç¬¼æ–‡å­— */
.lantern-word {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: 2rem;
    letter-spacing: 0.06em;
    line-height: 1;
    writing-mode: vertical-rl;
    text-orientation: upright;
    color: #ffe080;
    text-shadow:
        0 0 8px rgba(255, 200, 60, 0.6),
        0 1px 0 rgba(100, 60, 5, 0.8),
        0 2px 6px rgba(255, 180, 50, 0.3);
    z-index: 2;
}

/* ç©—å­ */
.lantern-tassel {
    position: absolute;
    bottom: -70px;
    left: 50%;
    transform-origin: top center;
    transform: translateX(-50%);
    display: flex;
    flex-direction: column;
    align-items: center;
}

/* å·¦ç¯ç¬¼ç©—å­ï¼šç¯ç¬¼æ­£æ‘†(5s)ï¼Œç©—å­åå‘å»¶è¿Ÿæ‘†åŠ¨ */
.lantern-left .lantern-tassel {
    animation: tasselSwing 5s ease-in-out infinite;
}

/* å³ç¯ç¬¼ç©—å­ï¼šç¯ç¬¼åå‘æ‘†(5.4s reverse)ï¼Œç©—å­åŒæ­¥ä½†åç›¸ */
.lantern-right .lantern-tassel {
    animation: tasselSwing 5.4s ease-in-out infinite reverse;
}

.tassel-knot {
    width: 14px;
    height: 14px;
    border-radius: 50%;
    background: radial-gradient(circle at 38% 36%, #ffd86e, #c49022);
    box-shadow: 0 2px 6px rgba(120, 70, 10, 0.4);
    margin-bottom: 2px;
}

.tassel-fringe {
    position: relative;
    width: 2px;
    height: 36px;
    background: linear-gradient(180deg, #e8b530, #c48a1a);
    border-radius: 0 0 2px 2px;
    transform-origin: top center;
    animation: fringeSwing 5s ease-in-out infinite;
}

.lantern-right .tassel-fringe {
    animation-duration: 5.4s;
    animation-direction: reverse;
}

.tassel-fringe::before,
.tassel-fringe::after {
    content: "";
    position: absolute;
    top: 0;
    width: 2px;
    height: 32px;
    background: linear-gradient(180deg, #dca82a, #b87a18);
    border-radius: 0 0 2px 2px;
}

.tassel-fringe::before { left: -6px; height: 28px; }
.tassel-fringe::after { left: 6px; height: 30px; }

/* ç¯ç¬¼æ‘†åŠ¨ */
@keyframes lanternSwing {
    0%, 100% { transform: rotate(5deg); }
    50% { transform: rotate(-5deg); }
}

/* ç©—å­æƒ¯æ€§æ‘†åŠ¨ï¼šä¸ç¯ç¬¼åå‘ï¼Œå¹…åº¦æ›´å¤§ï¼Œæœ‰å»¶è¿Ÿç›¸ä½ */
@keyframes tasselSwing {
    0% { transform: translateX(-50%) rotate(-6deg); }
    30% { transform: translateX(-50%) rotate(8deg); }
    50% { transform: translateX(-50%) rotate(7deg); }
    80% { transform: translateX(-50%) rotate(-8deg); }
    100% { transform: translateX(-50%) rotate(-6deg); }
}

/* æµè‹æœ«ç«¯é¢å¤–æ™ƒåŠ¨ï¼šæ›´è½»çš„æœ«ç«¯æ‘†å¹…æ›´å¤§ */
@keyframes fringeSwing {
    0% { transform: rotate(-3deg); }
    25% { transform: rotate(5deg); }
    50% { transform: rotate(4deg); }
    75% { transform: rotate(-5deg); }
    100% { transform: rotate(-3deg); }
}


.container {
    max-width: 700px;
    position: relative;
    z-index: 2;
    padding-top: 60px;
}

.header h1 {
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: clamp(2.2rem, 4.5vw, 3rem);
    color: #971717;
    letter-spacing: 0.04em;
}

.subtitle {
    color: #855f49;
    font-size: 1rem;
}

.newyear-chip {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    margin-top: 0.8rem;
    padding: 0.22rem 0.76rem;
    border-radius: 999px;
    border: 1px solid rgba(198, 38, 38, 0.35);
    background: linear-gradient(180deg, rgba(255, 222, 142, 0.3), rgba(255, 222, 142, 0.1));
    color: #a11616;
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: 1.06rem;
    letter-spacing: 0.08em;
    box-shadow: 0 6px 16px rgba(169, 24, 24, 0.14);
}

.header .spots-badge {
    background: rgba(188, 31, 31, 0.11) !important;
    border: 1px solid rgba(188, 31, 31, 0.26) !important;
    color: #8f1717 !important;
}

.card {
    background: var(--bg-glass-heavy);
    border: 1px solid rgba(188, 31, 31, 0.18);
    box-shadow: var(--shadow-lg);
}

.card h2 {
    color: #8f1717;
    font-size: 1.75rem;
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    letter-spacing: 0.02em;
}

.step-desc,
.form-group label,
.team-info,
.result-message,
.result-detail-label {
    color: var(--text-dim);
}

.form-help {
    margin-top: 0.45rem;
    color: var(--text-muted);
    font-size: 0.86rem;
}

.form-input {
    background: #fffdf9;
    border: 1px solid rgba(188, 31, 31, 0.2);
    color: #3f271a;
}

.form-input:focus {
    border-color: #bc1f1f;
    box-shadow: 0 0 0 3px rgba(188, 31, 31, 0.16);
    background: #fff9f0;
}

.btn {
    border-radius: 12px;
    font-weight: 700;
}

.btn-primary {
    background: linear-gradient(120deg, #bc1f1f 0%, #d84b1f 65%, #f0ac2f 100%);
    border: 1px solid rgba(255, 235, 194, 0.35);
    color: #fff8ea;
    box-shadow: 0 8px 18px rgba(188, 31, 31, 0.22);
}

.btn-primary:hover:not(:disabled) {
    box-shadow: 0 12px 22px rgba(188, 31, 31, 0.25);
}

.btn-secondary {
    background: linear-gradient(180deg, #fff8e8 0%, #f8ecd3 100%);
    border: 1px solid rgba(188, 31, 31, 0.18);
    color: #6f452f;
}

.team-card {
    background: rgba(255, 250, 242, 0.88);
    border: 1px solid rgba(188, 31, 31, 0.18);
}

.team-card:hover {
    background: rgba(255, 244, 226, 0.95);
    border-color: rgba(188, 31, 31, 0.3);
    box-shadow: var(--shadow-glow);
}

.team-card.selected {
    background: rgba(188, 31, 31, 0.1);
    border-color: #bc1f1f;
}

.team-name,
.result-title,
.result-detail-value {
    color: #8f1717;
}

.badge-plus {
    background: rgba(188, 31, 31, 0.14);
    color: #9f1818;
}

.badge-pro {
    background: rgba(244, 180, 61, 0.22);
    color: #915a13;
}

.result-details {
    background: rgba(255, 249, 240, 0.92);
    border: 1px solid rgba(188, 31, 31, 0.16);
}

.result-detail-item {
    border-bottom: 1px solid rgba(188, 31, 31, 0.12);
}

.toast.success {
    background-color: rgba(21, 115, 71, 0.94);
}

.toast.error {
    background-color: rgba(180, 35, 24, 0.94);
}

.toast.info {
    background-color: rgba(188, 31, 31, 0.92);
}

.header,
.card {
    animation: riseUpIn 0.65s ease both;
}

.step.active {
    animation: riseUpIn 0.38s ease;
}

@keyframes riseUpIn {
    from {
        opacity: 0;
        transform: translateY(12px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@media (max-width: 768px) {
    .festival-frame {
        inset: 8px;
        border-radius: 14px;
    }

    .festival-frame::before,
    .festival-frame::after {
        width: 40px;
        height: 40px;
        border-width: 2px;
    }

    .couplet-wrapper {
        width: 42px;
        height: 260px;
        top: 170px;
    }

    .couplet {
        font-size: 1.35rem;
        border-radius: 12px;
    }

    .couplet-wrapper.couplet-left {
        left: 4px;
    }

    .couplet-wrapper.couplet-right {
        right: 4px;
    }

    .crossbeam-wrapper {
        top: 18px;
        min-width: 132px;
        height: 36px;
    }

    .couplet-crossbeam {
        font-size: 1.1rem;
    }

    .lantern {
        width: 70px;
        top: 12px;
    }

    .lantern-left { left: 6px; }
    .lantern-right { right: 6px; }

    .lantern-line {
        top: -24px;
        height: 26px;
    }

    .lantern-ring {
        width: 50px;
        height: 12px;
    }

    .lantern-body {
        width: 70px;
        height: 96px;
        border-radius: 35px / 48px;
    }

    .lantern-word {
        font-size: 1.3rem;
    }

    .lantern-tassel {
        bottom: -50px;
    }

    .tassel-knot {
        width: 10px;
        height: 10px;
    }

    .tassel-fringe {
        height: 24px;
    }

    .tassel-fringe::before { height: 20px; left: -4px; }
    .tassel-fringe::after { height: 22px; left: 4px; }

    .newyear-chip {
        margin-top: 0.58rem;
        padding: 0.16rem 0.56rem;
        font-size: 0.92rem;
    }

    .container {
        max-width: 100%;
    }

    .card {
        padding: 1.6rem 1.2rem;
    }
}

/* ===== é£˜è½ç²’å­å®¹å™¨ ===== */
.falling-blossoms {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
    contain: layout style;
}

/* ç‰©ç†é©±åŠ¨ç²’å­ â€” transform ç”± JS å®æ—¶è®¾ç½® */
.phys-particle {
    position: absolute;
    top: 0;
    left: 0;
    will-change: transform;
}

/* ===== é‡‘è‰²ç¥¥äº‘ ===== */
.golden-clouds {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

.g-cloud {
    position: absolute;
    font-size: 3rem;
    color: rgba(244, 180, 61, 0.18);
    text-shadow: 0 0 20px rgba(244, 180, 61, 0.15);
}

.g-cloud-1 {
    top: 8%;
    left: 15%;
    font-size: 4rem;
    animation: cloudFloat 18s ease-in-out infinite;
}

.g-cloud-2 {
    top: 20%;
    right: 10%;
    font-size: 3.5rem;
    animation: cloudFloat 22s ease-in-out infinite 4s;
}

.g-cloud-3 {
    bottom: 15%;
    left: 8%;
    font-size: 3rem;
    animation: cloudFloat 20s ease-in-out infinite 8s;
}

@keyframes cloudFloat {
    0%, 100% { transform: translateX(0) translateY(0); }
    25% { transform: translateX(20px) translateY(-8px); }
    50% { transform: translateX(40px) translateY(4px); }
    75% { transform: translateX(15px) translateY(10px); }
}

/* ===== Header ç¦å­—æ°´å° ===== */
.header {
    position: relative;
}

.header-fu {
    position: absolute;
    top: -30px;
    left: 50%;
    transform: translateX(-50%) rotate(-12deg);
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif;
    font-size: 8rem;
    color: rgba(188, 31, 31, 0.06);
    pointer-events: none;
    z-index: -1;
    text-shadow: 0 0 40px rgba(188, 31, 31, 0.04);
    line-height: 1;
}

/* ===== å¡ç‰‡å¢å¼ºè£…é¥° ===== */
.card {
    position: relative;
    overflow: hidden;
}

.card::before {
    content: "";
    position: absolute;
    top: -1px;
    left: 20%;
    right: 20%;
    height: 3px;
    background: linear-gradient(90deg, transparent, #f4b43d, #bc1f1f, #f4b43d, transparent);
    border-radius: 0 0 4px 4px;
    z-index: 1;
}

.card::after {
    content: "âœ¦";
    position: absolute;
    top: 12px;
    right: 16px;
    font-size: 1.2rem;
    color: rgba(244, 180, 61, 0.25);
}

/* ===== è¾“å…¥æ¡†å¢å¼º ===== */
.form-input {
    transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
}

.form-input:focus {
    border-color: #bc1f1f;
    box-shadow: 0 0 0 3px rgba(188, 31, 31, 0.16), 0 0 20px rgba(244, 180, 61, 0.08);
    background: #fff9f0;
    transform: translateY(-1px);
}

/* ===== æŒ‰é’®å¢å¼º ===== */
.btn-primary {
    position: relative;
    overflow: hidden;
}

.btn-primary::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 60%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
    transition: left 0.6s ease;
}

.btn-primary:hover::before {
    left: 150%;
}

/* ===== æˆåŠŸç»“æœ æ–°å¹´çº¢åŒ…é£æ ¼ ===== */
.result-success {
    position: relative;
}

.result-success::before {
    content: "";
    position: absolute;
    top: -20px;
    left: -20px;
    right: -20px;
    bottom: -20px;
    background:
        radial-gradient(circle at 20% 80%, rgba(244, 180, 61, 0.08) 0%, transparent 40%),
        radial-gradient(circle at 80% 20%, rgba(188, 31, 31, 0.06) 0%, transparent 40%);
    pointer-events: none;
    z-index: -1;
    border-radius: 16px;
}

.result-title {
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif !important;
    font-size: 2.2rem !important;
    background: linear-gradient(135deg, #bc1f1f 0%, #d84b1f 50%, #f4b43d 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: titleGlow 2s ease-in-out infinite alternate;
}

@keyframes titleGlow {
    0% { filter: brightness(1) drop-shadow(0 0 0 transparent); }
    100% { filter: brightness(1.15) drop-shadow(0 0 12px rgba(244, 180, 61, 0.3)); }
}

/* ===== æˆåŠŸå‹¾é€‰åŠ¨ç”»å¢å¼º ===== */
.success-circle-path {
    fill: rgba(188, 31, 31, 0.08) !important;
    stroke: #bc1f1f !important;
}

.success-check-path {
    stroke: #bc1f1f !important;
}

.success-halo {
    border-color: rgba(188, 31, 31, 0.26) !important;
    box-shadow: 0 0 0 0 rgba(188, 31, 31, 0.22) !important;
}

.success-halo.is-animated {
    animation: successHaloPulseNY 1200ms ease-out both !important;
}

@keyframes successHaloPulseNY {
    0% {
        opacity: 0.8;
        transform: scale(0.72);
        box-shadow: 0 0 0 0 rgba(244, 180, 61, 0.4);
    }
    50% {
        opacity: 0.4;
        box-shadow: 0 0 20px 10px rgba(188, 31, 31, 0.15);
    }
    100% {
        opacity: 0;
        transform: scale(1.4);
        box-shadow: 0 0 0 20px rgba(244, 180, 61, 0);
    }
}

/* ===== ç¥ç¦è¯­å¢å¼º ===== */
.result-blessing {
    background: linear-gradient(135deg, rgba(188, 31, 31, 0.12), rgba(244, 180, 61, 0.15)) !important;
    border: 1px solid rgba(188, 31, 31, 0.3) !important;
    color: #971717 !important;
    font-family: 'Ma Shan Zheng', 'Noto Serif SC', serif !important;
    font-size: 1.15rem !important;
    padding: 0.35rem 1.2rem !important;
    text-shadow: 0 1px 2px rgba(244, 180, 61, 0.2);
    animation: blessingPulse 2s ease-in-out infinite alternate !important;
}

@keyframes blessingPulse {
    0% { box-shadow: 0 0 0 0 rgba(188, 31, 31, 0.1); }
    100% { box-shadow: 0 0 16px 4px rgba(244, 180, 61, 0.15); }
}

/* ===== ç»“æœè¯¦æƒ…å¢å¼º ===== */
.result-details {
    position: relative;
    overflow: hidden;
}

.result-details::before {
    content: "ç¦";
    position: absolute;
    top: 50%;
    right: 12px;
    transform: translateY(-50%) rotate(-15deg);
    font-family: 'Ma Shan Zheng', serif;
    font-size: 4rem;
    color: rgba(188, 31, 31, 0.05);
    pointer-events: none;
}

/* ===== é¡µé¢åŠ è½½åŠ¨ç”»å¢å¼º ===== */
.header {
    animation: headerFloat 0.8s ease both !important;
}

.header h1 {
    animation: titleReveal 0.9s ease both 0.1s;
}

@keyframes headerFloat {
    0% { opacity: 0; transform: translateY(-20px); }
    100% { opacity: 1; transform: translateY(0); }
}

@keyframes titleReveal {
    0% { opacity: 0; transform: translateY(15px) scale(0.95); }
    60% { transform: translateY(-3px) scale(1.02); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
}

.newyear-chip {
    animation: chipBounce 0.6s ease both 0.4s !important;
}

@keyframes chipBounce {
    0% { opacity: 0; transform: scale(0.5); }
    60% { transform: scale(1.15); }
    100% { opacity: 1; transform: scale(1); }
}

/* ===== è¡¨å•ç»„åŠ¨ç”» ===== */
.form-group {
    margin-bottom: 1.4rem;
    animation: formSlideIn 0.5s ease both;
}

.form-group:last-child {
    margin-bottom: 1.6rem;
}

.form-group:nth-child(1) { animation-delay: 0.15s; }
.form-group:nth-child(2) { animation-delay: 0.25s; }

@keyframes formSlideIn {
    0% { opacity: 0; transform: translateX(-12px); }
    100% { opacity: 1; transform: translateX(0); }
}

/* ===== Spots å¾½ç«  ===== */
.spots-badge {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: rgba(188, 31, 31, 0.11);
    padding: 6px 14px;
    border-radius: 20px;
    font-size: 0.9rem;
    color: #8f1717;
    margin-top: 10px;
    border: 1px solid rgba(188, 31, 31, 0.26);
}

/* ===== åŠŸèƒ½åˆ‡æ¢æ ‡ç­¾ ===== */
.tab-switcher {
    display: flex;
    gap: 0;
    margin-bottom: 1.5rem;
    background: rgba(255,255,255,0.6);
    border-radius: 12px;
    padding: 4px;
    border: 1px solid rgba(188, 31, 31, 0.12);
}

.tab-btn {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 10px 16px;
    border: none;
    background: transparent;
    border-radius: 9px;
    font-size: 0.95rem;
    font-weight: 500;
    color: #666;
    cursor: pointer;
    transition: color 0.35s ease;
    font-family: inherit;
    position: relative;
    z-index: 1;
}

.tab-btn:hover {
    color: #333;
    background: rgba(188, 31, 31, 0.05);
}

.tab-btn.active {
    background: transparent;
    color: #fff;
    box-shadow: none;
}

.tab-btn.active:hover {
    background: transparent;
    color: #fff;
}

/* ===== æ ‡ç­¾æ»‘åŠ¨æŒ‡ç¤ºå™¨ ===== */
.tab-switcher {
    position: relative;
}

.tab-switcher::before {
    content: '';
    position: absolute;
    top: 4px;
    left: 4px;
    width: calc(50% - 4px);
    height: calc(100% - 8px);
    background: linear-gradient(135deg, #bc1f1f, #d84b1f);
    border-radius: 9px;
    box-shadow: 0 2px 8px rgba(188, 31, 31, 0.3);
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 0;
}

.tab-switcher.warranty-active::before {
    transform: translateX(100%);
}

/* ===== å…¬å‘Šæ  ===== */
.announcement-bar {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 1.25rem;
    padding: 0.85rem 1.2rem;
    background: linear-gradient(135deg, rgba(255, 233, 165, 0.5), rgba(255, 245, 215, 0.6));
    border: 1px solid rgba(244, 180, 61, 0.45);
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(188, 31, 31, 0.06);
    animation: announcementSlide 0.5s ease both;
}

@keyframes announcementSlide {
    0% { opacity: 0; transform: translateY(-10px); }
    100% { opacity: 1; transform: translateY(0); }
}

.announcement-icon {
    font-size: 1.3rem;
    flex-shrink: 0;
}

.announcement-content {
    flex: 1;
    min-width: 0;
}

.announcement-text {
    font-size: 0.9rem;
    color: #5a3e19;
    line-height: 1.6;
    word-break: break-word;
}

.announcement-close {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    border: none;
    background: rgba(188, 31, 31, 0.1);
    border-radius: 6px;
    color: #8f1717;
    font-size: 1.1rem;
    line-height: 1;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.announcement-close:hover {
    background: rgba(188, 31, 31, 0.2);
}

/* ===== å¡ç‰‡å¤´éƒ¨æ¡ ===== */
.card-header-strip {
    display: flex;
    align-items: flex-start;
    gap: 14px;
    margin-bottom: 1.6rem;
    padding-bottom: 1.2rem;
    border-bottom: 1px solid rgba(188, 31, 31, 0.1);
}

.card-header-strip h2 {
    margin-bottom: 0;
    font-size: 1.5rem;
    line-height: 1.2;
}

.card-header-sub {
    color: var(--text-muted);
    font-size: 0.85rem;
    margin-top: 4px;
    line-height: 1.4;
}

.card-header-icon {
    width: 48px;
    height: 48px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    background: linear-gradient(135deg, rgba(188, 31, 31, 0.12), rgba(216, 75, 31, 0.12));
    color: #bc1f1f;
    box-shadow: 0 4px 10px rgba(188, 31, 31, 0.08);
}

.card-header-icon.warranty-icon {
    background: linear-gradient(135deg, rgba(34, 139, 34, 0.12), rgba(59, 130, 246, 0.12));
    color: #228b22;
    box-shadow: 0 4px 10px rgba(34, 139, 34, 0.08);
}

/* ===== è´¨ä¿æç¤ºæ¡† ===== */
.warranty-tip {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 0.9rem 1.1rem;
    margin-bottom: 1.5rem;
    background: linear-gradient(135deg, rgba(232, 165, 23, 0.06), rgba(188, 31, 31, 0.06));
    border: 1px solid rgba(188, 31, 31, 0.1);
    border-radius: 10px;
    font-size: 0.88rem;
    line-height: 1.6;
    color: var(--text-dim);
}

.warranty-tip-icon {
    font-size: 1.3rem;
    flex-shrink: 0;
}

.warranty-tip-text {
    flex: 1;
}

.warranty-tip-text strong {
    color: #bc1f1f;
}

/* ===== è´¨ä¿ç»“æœå¡ç‰‡ ===== */
.warranty-info-card {
    background: linear-gradient(135deg, rgba(232, 165, 23, 0.06), rgba(188, 31, 31, 0.06));
    border: 1px solid rgba(188, 31, 31, 0.12);
    border-radius: 12px;
    padding: 1.2rem;
    margin-bottom: 1rem;
}

.warranty-info-card .wi-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0.5rem 0;
    border-bottom: 1px solid rgba(0, 0, 0, 0.04);
    font-size: 0.9rem;
}

.warranty-info-card .wi-row:last-child { border-bottom: none; }
.warranty-info-card .wi-label { color: #666; }
.warranty-info-card .wi-value { font-weight: 600; color: #333; }

.wi-badge {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
}

.wi-badge-ok { background: rgba(34, 197, 94, 0.12); color: #16a34a; }
.wi-badge-warn { background: rgba(234, 179, 8, 0.12); color: #b45309; }
.wi-badge-danger { background: rgba(239, 68, 68, 0.12); color: #dc2626; }

.warranty-records { margin-top: 0.8rem; }
.warranty-records h4 { font-size: 0.9rem; color: #666; margin-bottom: 0.5rem; }

.wr-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 0.4rem 0;
    font-size: 0.85rem;
    color: #555;
}

.wr-item .wr-tag {
    font-size: 0.72rem;
    padding: 1px 6px;
    border-radius: 4px;
    background: rgba(188, 31, 31, 0.08);
    color: #bc1f1f;
}

/* ===== input-wrapper ===== */
.input-wrapper {
    position: relative;
}

/* ===== çª—èŠ±è£…é¥° ===== */
.paper-cuts {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 2;
}

.paper-cut {
    position: absolute;
    font-size: 4.5rem;
    color: rgba(188, 31, 31, 0.12);
}

.paper-cut-tl { top: 80px; left: 20px; transform: rotate(-15deg); }
.paper-cut-tr { top: 80px; right: 20px; transform: rotate(20deg); }
.paper-cut-bl { bottom: 30px; left: 20px; transform: rotate(10deg); }
.paper-cut-br { bottom: 30px; right: 20px; transform: rotate(-25deg); }

/* ===== é­ç‚®è£…é¥° ===== */
.firecrackers {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 3;
}

.firecracker-string {
    position: absolute;
    top: 0;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding-top: 8px;
}

.firecracker-left { left: 68px; }
.firecracker-right { right: 68px; }

.firecracker-string::before {
    content: "";
    width: 2px;
    height: 16px;
    background: linear-gradient(180deg, #d4a327, #b8860b);
    border-radius: 2px;
}

.fc-item {
    display: block;
    width: 14px;
    height: 20px;
    background: linear-gradient(180deg, #e63030, #b81818);
    border-radius: 3px;
    border: 1px solid rgba(246, 199, 84, 0.5);
    position: relative;
    box-shadow: 0 2px 6px rgba(188, 31, 31, 0.2);
}

.fc-item::before {
    content: "";
    position: absolute;
    top: -3px;
    left: 50%;
    transform: translateX(-50%);
    width: 1.5px;
    height: 5px;
    background: #d4a327;
}

.fc-item::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 8px;
    height: 1px;
    background: rgba(246, 199, 84, 0.6);
}

.fc-item:nth-child(odd) { margin-left: 6px; }
.fc-item:nth-child(even) { margin-right: 6px; }

/* ===== é‡‘å…ƒå®æµ®åŠ¨ ===== */
.gold-ingots {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

.ingot {
    position: absolute;
    font-size: 1.6rem;
    opacity: 0.15;
}

.ingot-1 { top: 12%; left: 6%; }
.ingot-2 { top: 35%; right: 5%; }
.ingot-3 { bottom: 20%; left: 10%; }
.ingot-4 { top: 55%; left: 4%; }
.ingot-5 { bottom: 35%; right: 8%; }

/* ===== é‡‘è‰²å…‰ç‚¹ ===== */
.sparkle-field {
    position: fixed;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

.sparkle-dot {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 50%;
    background: rgba(244, 180, 61, 0.6);
    box-shadow: 0 0 4px 1px rgba(244, 180, 61, 0.2);
    animation: sparkleTwinkle 6s ease-in-out infinite;
}

.sd-1 { top: 10%; left: 18%; animation-delay: 0s; }
.sd-2 { top: 22%; right: 22%; animation-delay: 1.5s; }
.sd-3 { top: 40%; left: 8%; animation-delay: 3s; }
.sd-4 { top: 58%; right: 12%; animation-delay: 4.5s; }
.sd-5 { bottom: 30%; left: 22%; }
.sd-6 { bottom: 18%; right: 18%; }
.sd-7 { top: 15%; left: 45%; width: 3px; height: 3px; }
.sd-8 { bottom: 40%; right: 35%; width: 5px; height: 5px; }

/* only animate 4 dots, rest are static */
.sd-5, .sd-6, .sd-7, .sd-8 { animation: none; }

@keyframes sparkleTwinkle {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.9; }
}

/* ===== èƒŒæ™¯å¢å¼º - å›çº¹åº•çº¹ ===== */
body {
    background:
        radial-gradient(circle at 12% 14%, rgba(244, 180, 61, 0.28), transparent 34%),
        radial-gradient(circle at 85% 8%, rgba(188, 31, 31, 0.14), transparent 34%),
        radial-gradient(circle at 50% 90%, rgba(244, 180, 61, 0.12), transparent 40%),
        radial-gradient(circle at 90% 60%, rgba(188, 31, 31, 0.08), transparent 30%),
        repeating-linear-gradient(145deg, rgba(240, 199, 118, 0.11) 0 2px, rgba(253, 246, 231, 0) 2px 8px),
        url("data:image/svg+xml,%3Csvg width='40' height='40' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M0 0h10v10H0zm20 0h10v10H20zM10 10h10v10H10zm20 10h10v10H30zM0 20h10v10H0zm20 20h10v10H20zM10 30h10v10H10zm20 10h10v10H30z' fill='rgba(188,31,31,0.018)' fill-rule='evenodd'/%3E%3C/svg%3E"),
        linear-gradient(180deg, #fff8ea 0%, #f7e8ce 42%, #fff6e4 100%);
}

/* ===== å¡ç‰‡å¢å¼º - è§’è½è£…é¥° ===== */
.redeem-card {
    position: relative;
}

.redeem-card::after {
    content: "ç¦";
    position: absolute;
    top: 12px;
    right: 16px;
    font-family: 'Ma Shan Zheng', serif;
    font-size: 1.6rem;
    color: rgba(188, 31, 31, 0.08);
}

/* ===== æ ‡é¢˜æ¸å˜æ–‡å­— ===== */
.header h1 {
    background: linear-gradient(135deg, #971717 0%, #bc1f1f 40%, #d84b1f 70%, #f4b43d 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* ===== è¡¨å•è¾“å…¥æ¡†å¢å¼º - çº¢è‰²å·¦ä¾§æ¡ ===== */
.form-input {
    border-left: 3px solid rgba(188, 31, 31, 0.3);
    padding-left: 14px;
}

.form-input:focus {
    border-left-color: #bc1f1f;
}

/* ===== æŒ‰é’®æ‚¬æµ®æ€å¢å¼º ===== */
.btn-primary:hover:not(:disabled) {
    transform: translateY(-3px);
    box-shadow: 0 14px 28px rgba(188, 31, 31, 0.28), 0 0 0 2px rgba(244, 180, 61, 0.15);
}

.btn-primary:active:not(:disabled) {
    transform: translateY(-1px);
    box-shadow: 0 6px 14px rgba(188, 31, 31, 0.2);
}

/* ===== å…è´¹è½¦ä½å…¥å£æ¨ªå¹… ===== */
.freespot-banner {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 0.75rem 1.1rem;
    margin-bottom: 1rem;
    background: linear-gradient(135deg, rgba(245, 158, 11, 0.1) 0%, rgba(217, 119, 6, 0.08) 100%);
    border: 1px solid rgba(245, 158, 11, 0.25);
    border-radius: 12px;
    text-decoration: none;
    color: #92400e;
    transition: border-color 0.2s, box-shadow 0.2s, transform 0.2s;
    cursor: pointer;
}

.freespot-banner:hover {
    border-color: rgba(245, 158, 11, 0.5);
    box-shadow: 0 4px 14px rgba(245, 158, 11, 0.12);
    transform: translateY(-1px);
}

.freespot-banner-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 8px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: #fff;
    flex-shrink: 0;
}

.freespot-banner-icon svg { width: 18px; height: 18px; }

.freespot-banner-text {
    font-weight: 700;
    font-size: 0.95rem;
}

.freespot-banner-desc {
    font-size: 0.8rem;
    color: #b45309;
    opacity: 0.75;
}

.freespot-banner-arrow {
    margin-left: auto;
    opacity: 0.5;
    flex-shrink: 0;
}

.freespot-banner-arrow svg { width: 18px; height: 18px; }

/* ===== å…è´¹è½¦ä½é¢æ¿ ===== */
.freespot-icon {
    background: linear-gradient(135deg, #f59e0b, #d97706) !important;
}

.freespot-list {
    margin-top: 1rem;
}

.freespot-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
    padding: 0.9rem 1rem;
    background: rgba(255, 255, 255, 0.7);
    border: 1px solid rgba(244, 180, 61, 0.2);
    border-radius: 10px;
    margin-bottom: 0.6rem;
    transition: border-color 0.2s, box-shadow 0.2s;
}

.freespot-item:hover {
    border-color: rgba(244, 180, 61, 0.45);
    box-shadow: 0 2px 8px rgba(244, 180, 61, 0.1);
}

.freespot-info {
    flex: 1;
    min-width: 0;
}

.freespot-name {
    font-weight: 600;
    font-size: 0.95rem;
    color: #333;
    margin-bottom: 4px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.freespot-meta {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 0.8rem;
    color: #888;
}

.freespot-meta span {
    display: inline-flex;
    align-items: center;
    gap: 3px;
}

.freespot-avail {
    color: #16a34a;
    font-weight: 500;
}

.freespot-join-btn {
    flex-shrink: 0;
    width: auto !important;
    min-width: 80px;
    padding: 6px 14px !important;
    font-size: 0.85rem !important;
    border-radius: 8px !important;
}

/* ===== ç§»åŠ¨ç«¯è°ƒæ•´ ===== */
@media (max-width: 768px) {
    .golden-clouds { display: none; }
    .header-fu { font-size: 5rem; top: -20px; }
    .falling-blossoms { opacity: 0.7; }

    .card-header-strip {
        gap: 10px;
    }
    .card-header-icon {
        width: 40px;
        height: 40px;
    }
    .card-header-strip h2 {
        font-size: 1.3rem;
    }
    .announcement-bar {
        padding: 0.7rem 0.9rem;
        gap: 8px;
    }
    .announcement-text {
        font-size: 0.82rem;
    }

    /* ç§»åŠ¨ç«¯éšè—/ç¼©å°éƒ¨åˆ†è£…é¥° */
    .paper-cut { font-size: 2.5rem; opacity: 0.6; }
    .paper-cut-tl { top: 60px; left: 8px; }
    .paper-cut-tr { top: 60px; right: 8px; }
    .paper-cut-bl { bottom: 16px; left: 8px; }
    .paper-cut-br { bottom: 16px; right: 8px; }

    .firecrackers { display: none; }

    .ingot { font-size: 1.2rem; opacity: 0.12; }

    .sparkle-field { display: none; }
    .gold-ingots { display: none; }
}

/* ===== å‡å°‘åŠ¨ç”»åå¥½ ===== */
@media (prefers-reduced-motion: reduce) {
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
    }
    .falling-blossoms,
    .paper-cuts,
    .firecrackers,
    .gold-ingots,
    .sparkle-field,
    .golden-clouds { display: none !important; }
}

</style>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
</head>
<body>
    <!-- é£˜è½æ¢…èŠ±/æ¨±èŠ±ç²’å­ -->
    <div class="falling-blossoms" aria-hidden="true" id="fallingBlossoms"><span class="phys-particle" style="font-size: 23.9162px; contain: layout style; opacity: 0.526; transform: translate3d(668.4px, 141.5px, 0px) rotateX(369.4deg) rotateY(281.7deg) rotateZ(-71.6deg);">âœ¿</span><span class="phys-particle" style="font-size: 14.2648px; contain: layout style; opacity: 0.44; transform: translate3d(432.3px, 656.8px, 0px) rotateX(684.3deg) rotateY(778.9deg) rotateZ(232.7deg);">ğŸµ</span><span class="phys-particle" style="font-size: 24.4298px; contain: layout style; opacity: 0.027; transform: translate3d(333.3px, -53.2px, 0px) rotateX(413.4deg) rotateY(661.2deg) rotateZ(277.1deg);">â€</span><span class="phys-particle" style="font-size: 16.4592px; contain: layout style; opacity: 0.404; transform: translate3d(500.3px, 859.6px, 0px) rotateX(-4.1deg) rotateY(68.6deg) rotateZ(9.5deg);">âœ¿</span><span class="phys-particle" style="font-size: 19.0869px; contain: layout style; opacity: 0.457; transform: translate3d(471.6px, 383.8px, 0px) rotateX(71.9deg) rotateY(-26.1deg) rotateZ(699.6deg);">ğŸŒ¸</span></div>
    <!-- é‡‘è‰²ç¥¥äº‘ -->
    <div class="golden-clouds" aria-hidden="true">
        <div class="g-cloud g-cloud-1">â˜</div>
        <div class="g-cloud g-cloud-2">â˜</div>
        <div class="g-cloud g-cloud-3">â˜</div>
    </div>
    <div class="festival-frame" aria-hidden="true"></div>

    <!-- çª—èŠ±è£…é¥° -->
    <div class="paper-cuts" aria-hidden="true">
        <div class="paper-cut paper-cut-tl">âœ¿</div>
        <div class="paper-cut paper-cut-tr">âœ¿</div>
        <div class="paper-cut paper-cut-bl">âœ¿</div>
        <div class="paper-cut paper-cut-br">âœ¿</div>
    </div>

    <!-- é­ç‚®è£…é¥° -->
    <div class="firecrackers" aria-hidden="true">
        <div class="firecracker-string firecracker-left">
            <span class="fc-item"></span><span class="fc-item"></span><span class="fc-item"></span>
            <span class="fc-item"></span><span class="fc-item"></span><span class="fc-item"></span>
        </div>
        <div class="firecracker-string firecracker-right">
            <span class="fc-item"></span><span class="fc-item"></span><span class="fc-item"></span>
            <span class="fc-item"></span><span class="fc-item"></span><span class="fc-item"></span>
        </div>
    </div>

    <!-- é‡‘å…ƒå® -->
    <div class="gold-ingots" aria-hidden="true">
        <div class="ingot ingot-1">ğŸ¥‡</div>
        <div class="ingot ingot-2">ğŸ’°</div>
        <div class="ingot ingot-3">ğŸ®</div>
        <div class="ingot ingot-4">â­</div>
        <div class="ingot ingot-5">ğŸŠ</div>
    </div>

    <!-- é‡‘è‰²å…‰ç‚¹ -->
    <div class="sparkle-field" aria-hidden="true">
        <div class="sparkle-dot sd-1"></div>
        <div class="sparkle-dot sd-2"></div>
        <div class="sparkle-dot sd-3"></div>
        <div class="sparkle-dot sd-4"></div>
        <div class="sparkle-dot sd-5"></div>
        <div class="sparkle-dot sd-6"></div>
        <div class="sparkle-dot sd-7"></div>
        <div class="sparkle-dot sd-8"></div>
    </div>
    <div class="page-lanterns" aria-hidden="true">
        <div class="lantern lantern-left">
            <div class="lantern-line"></div>
            <div class="lantern-ring lantern-ring-top"></div>
            <div class="lantern-body">
                <div class="lantern-glow"></div>
                <span class="lantern-word">æ–°æ˜¥</span>
            </div>
            <div class="lantern-ring lantern-ring-bottom"></div>
            <div class="lantern-tassel">
                <div class="tassel-knot"></div>
                <div class="tassel-fringe"></div>
            </div>
        </div>
        <div class="lantern lantern-right">
            <div class="lantern-line"></div>
            <div class="lantern-ring lantern-ring-top"></div>
            <div class="lantern-body">
                <div class="lantern-glow"></div>
                <span class="lantern-word">å¿«ä¹</span>
            </div>
            <div class="lantern-ring lantern-ring-bottom"></div>
            <div class="lantern-tassel">
                <div class="tassel-knot"></div>
                <div class="tassel-fringe"></div>
            </div>
        </div>
    </div>
    <div class="festival-couplets" aria-hidden="true">
        <div class="couplet-wrapper couplet-left">
            <div class="couplet-inner">
                <div class="couplet couplet-front">æ˜¥å›å¤§åœ°åƒå±±ç§€</div>
                <div class="couplet couplet-back">çˆ†ç«¹å£°ä¸­è¾æ—§å²</div>
            </div>
        </div>
        <div class="couplet-wrapper couplet-right">
            <div class="couplet-inner">
                <div class="couplet couplet-front">æ—¥æš–ç¥å·ä¸‡ç‰©è£</div>
                <div class="couplet couplet-back">æ¢…èŠ±é¦™é‡ŒæŠ¥æ–°æ˜¥</div>
            </div>
        </div>
        <div class="crossbeam-wrapper">
            <div class="crossbeam-inner">
                <div class="couplet-crossbeam crossbeam-front">æ˜¥æ„ç›ç„¶</div>
                <div class="couplet-crossbeam crossbeam-back">ä¸‡è±¡æ›´æ–°</div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="header-fu" aria-hidden="true">ç¦</div>
            <h1><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="gift" aria-hidden="true" style="width:32px;height:32px;vertical-align:-4px;margin-right:4px;" class="lucide lucide-gift"><rect x="3" y="8" width="18" height="4" rx="1"></rect><path d="M12 8v13"></path><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"></path><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"></path></svg> GPT Team å…‘æ¢</h1>
            <p class="subtitle">âœ¨ æ–°æ˜¥å–œè¿ Â· ä½¿ç”¨å…‘æ¢ç åŠ å…¥ ChatGPT Team âœ¨</p>
            <div class="newyear-chip">ğŸ´ é©¬å¹´å¤§å‰</div>
            
            <div class="spots-badge">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="users" aria-hidden="true" class="lucide lucide-users"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path><path d="M16 3.128a4 4 0 0 1 0 7.744"></path><path d="M22 21v-2a4 4 0 0 0-3-3.87"></path><circle cx="9" cy="7" r="4"></circle></svg> å‰©ä½™è½¦ä½: 1
            </div>
            
        </div>

        <!-- å…¬å‘Šæ  -->
        

        <!-- å…è´¹è½¦ä½å…¥å£ -->
        <a href="/free-spot" class="freespot-banner">
            <span class="freespot-banner-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="zap" aria-hidden="true" class="lucide lucide-zap"><path d="M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z"></path></svg></span>
            <span class="freespot-banner-text">å…è´¹è½¦ä½</span>
            <span class="freespot-banner-desc">æ— éœ€å…‘æ¢ç ï¼Œç›´æ¥ä¸Šè½¦</span>
            <span class="freespot-banner-arrow"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="chevron-right" aria-hidden="true" class="lucide lucide-chevron-right"><path d="m9 18 6-6-6-6"></path></svg></span>
        </a>

        <!-- åŠŸèƒ½åˆ‡æ¢æ ‡ç­¾ -->
        <div class="tab-switcher">
            <button class="tab-btn active" onclick="switchTab('redeem')" id="tab-redeem">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="gift" aria-hidden="true" class="lucide lucide-gift"><rect x="3" y="8" width="18" height="4" rx="1"></rect><path d="M12 8v13"></path><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"></path><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"></path></svg> å…‘æ¢ç å…‘æ¢
            </button>
            <button class="tab-btn" onclick="switchTab('warranty')" id="tab-warranty">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="shield-check" aria-hidden="true" class="lucide lucide-shield-check"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path><path d="m9 12 2 2 4-4"></path></svg> è´¨ä¿æŸ¥è¯¢
            </button>
        </div>

        <!-- æ­¥éª¤1: è¾“å…¥å…‘æ¢ä¿¡æ¯ -->
        <div id="step1" class="step active">
            <div class="card redeem-card">
                <div class="card-header-strip">
                    <div class="card-header-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="gift" aria-hidden="true" class="lucide lucide-gift"><rect x="3" y="8" width="18" height="4" rx="1"></rect><path d="M12 8v13"></path><path d="M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"></path><path d="M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"></path></svg></div>
                    <div>
                        <h2>è¾“å…¥å…‘æ¢ä¿¡æ¯</h2>
                        <p class="card-header-sub">å¡«å†™é‚®ç®±å’Œå…‘æ¢ç ï¼Œå³å¯åŠ å…¥ ChatGPT Team</p>
                    </div>
                </div>
                <form id="verifyForm">
                    <div class="form-group">
                        <label for="email"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="mail" aria-hidden="true" style="width:14px;height:14px;vertical-align:-2px;margin-right:4px;" class="lucide lucide-mail"><path d="m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7"></path><rect x="2" y="4" width="20" height="16" rx="2"></rect></svg>é‚®ç®±åœ°å€</label>
                        <div class="input-wrapper">
                            <input type="email" id="email" name="email" required="" placeholder="è¯·è¾“å…¥æ‚¨çš„é‚®ç®±åœ°å€" class="form-input">
                        </div>
                        <p class="form-help">é‚€è¯·å°†å‘é€åˆ°æ­¤é‚®ç®±ï¼Œè¯·ç¡®ä¿å¯æ­£å¸¸æ¥æ”¶</p>
                    </div>

                    <div class="form-group">
                        <label for="code"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="key-round" aria-hidden="true" style="width:14px;height:14px;vertical-align:-2px;margin-right:4px;" class="lucide lucide-key-round"><path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z"></path><circle cx="16.5" cy="7.5" r=".5" fill="currentColor"></circle></svg>å…‘æ¢ç </label>
                        <div class="input-wrapper">
                            <input type="text" id="code" name="code" required="" placeholder="è¯·è¾“å…¥å…‘æ¢ç " class="form-input">
                        </div>
                    </div>

                    <button type="submit" class="btn btn-primary" id="verifyBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="arrow-right-circle" aria-hidden="true" class="lucide lucide-arrow-right-circle"><circle cx="12" cy="12" r="10"></circle><path d="m12 16 4-4-4-4"></path><path d="M8 12h8"></path></svg> éªŒè¯å¹¶å…‘æ¢
                    </button>
                </form>
            </div>
        </div>

        <!-- æ­¥éª¤2: é€‰æ‹© Team (å·²åºŸå¼ƒï¼Œä¿ç•™å ä½é˜²æ­¢ JS æŠ¥é”™) -->
        <div id="step2" class="step" style="display: none;">
            <div class="card">
                <h2>é€‰æ‹© Team</h2>
                <div id="teamsList" class="teams-list"></div>
                <div class="actions">
                    <button onclick="backToStep1()" class="btn btn-secondary">è¿”å›</button>
                    <button onclick="autoSelectTeam()" class="btn btn-primary">è‡ªåŠ¨é€‰æ‹©</button>
                </div>
            </div>
        </div>

        <!-- æ­¥éª¤3: å…‘æ¢ç»“æœ -->
        <div id="step3" class="step">
            <div class="card">
                <div id="resultContent">
                    <!-- ç»“æœå†…å®¹å°†é€šè¿‡ JavaScript åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>
        </div>

        <!-- è´¨ä¿æŸ¥è¯¢é¢æ¿ -->
        <div id="warrantyPanel" class="step" style="display: none;">
            <div class="card warranty-card">
                <div class="card-header-strip">
                    <div class="card-header-icon warranty-icon"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="shield-check" aria-hidden="true" class="lucide lucide-shield-check"><path d="M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z"></path><path d="m9 12 2 2 4-4"></path></svg></div>
                    <div>
                        <h2>è´¨ä¿æŸ¥è¯¢</h2>
                        <p class="card-header-sub">å°å·åå¯å‡­åŸå…‘æ¢ç é‡æ–°åŠ å…¥ Team</p>
                    </div>
                </div>
                <div class="warranty-tip">
                    <div class="warranty-tip-icon">ğŸ›¡ï¸</div>
                    <div class="warranty-tip-text">
                        å¦‚æœæ‚¨ä½¿ç”¨<strong>è´¨ä¿å…‘æ¢ç </strong>åŠ å…¥çš„ Team è¢«å°å·ï¼Œå¯ä»¥åœ¨è´¨ä¿æœŸå†…é‡å¤ä½¿ç”¨åŸå…‘æ¢ç é‡æ–°åŠ å…¥ã€‚
                    </div>
                </div>
                <form id="warrantyForm">
                    <div class="form-group">
                        <label for="warrantyCode"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="key-round" aria-hidden="true" style="width:14px;height:14px;vertical-align:-2px;margin-right:4px;" class="lucide lucide-key-round"><path d="M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z"></path><circle cx="16.5" cy="7.5" r=".5" fill="currentColor"></circle></svg>å…‘æ¢ç </label>
                        <div class="input-wrapper">
                            <input type="text" id="warrantyCode" name="warrantyCode" required="" placeholder="è¯·è¾“å…¥æ‚¨çš„å…‘æ¢ç " class="form-input">
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" id="warrantyQueryBtn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-lucide="search" aria-hidden="true" class="lucide lucide-search"><path d="m21 21-4.34-4.34"></path><circle cx="11" cy="11" r="8"></circle></svg> æŸ¥è¯¢è´¨ä¿çŠ¶æ€
                    </button>
                </form>
                <div id="warrantyResult" style="margin-top: 1.5rem;"></div>
            </div>
        </div>
    </div>

    <!-- Toast æç¤º -->
    <div id="toast" class="toast"></div>

    <script>
// é¢ã„¦åŸ›éæˆå´²æ¤¤ç”¸æ½°JavaScript

// HTMLæîƒ¿ç®Ÿé‘èŠ¥æšŸ - é—ƒå‰î„›XSSé€è¯²åš®
function escapeHtml(unsafe) {
    if (unsafe === null || unsafe === undefined) {
        return '';
    }
    return String(unsafe)
        .replace(/&/g, "&amp;")
        .replace(/</g, "&lt;")
        .replace(/>/g, "&gt;")
        .replace(/"/g, "&quot;")
        .replace(/'/g, "&#039;");
}

// éã„¥çœ¬é™æ©€å™º
let currentEmail = '';
let currentCode = '';
let availableTeams = [];
let selectedTeamId = null;
let cleanupCelebration = null;
const HORSE_YEAR_BLESSINGS = [
    '\u9a6c\u5230\u6210\u529f\uff0c\u4e07\u4e8b\u987a\u610f\uff01',
    '\u9a6c\u5e74\u5927\u5409\uff0c\u9616\u5bb6\u5e78\u5b89\uff01',
    '\u9f99\u9a6c\u7cbe\u795e\uff0c\u597d\u8fd0\u957f\u968f\uff01',
    '\u9a6c\u5e74\u5982\u610f\uff0c\u798f\u6ee1\u65b0\u6625\uff01',
    '\u9a8f\u9a6c\u5954\u817e\uff0c\u524d\u7a0b\u9526\u7ee3\uff01',
    '\u9a6c\u97ec\u58f0\u58f0\uff0c\u559c\u4e8b\u8fde\u8fde\uff01',
    '\u4e00\u8dc3\u5343\u91cc\uff0c\u5fc3\u60f3\u4e8b\u6210\uff01',
    '\u65b0\u5c81\u9a6c\u5f00\u65b0\u7bc7\uff0c\u987a\u98ce\u987a\u6c34\uff01'
];

function getRandomHorseYearBlessing() {
    const index = Math.floor(Math.random() * HORSE_YEAR_BLESSINGS.length);
    return HORSE_YEAR_BLESSINGS[index];
}

function animateSuccessCheck() {
    const iconWrap = document.querySelector('.result-success .result-icon.success-check-animate');
    if (!iconWrap) return;

    iconWrap.classList.remove('is-animated');
    // Force reflow so repeated success can replay animation.
    void iconWrap.offsetWidth;
    iconWrap.classList.add('is-animated');

    const halo = iconWrap.querySelector('.success-halo');
    if (halo) {
        halo.classList.remove('is-animated');
        void halo.offsetWidth;
        halo.classList.add('is-animated');
    }

    const animatePath = (path, duration, delay) => {
        if (!path || typeof path.getTotalLength !== 'function') return;
        const length = path.getTotalLength();
        if (!length) return;

        path.style.strokeDasharray = `${length}`;
        path.style.strokeDashoffset = `${length}`;
        path.style.transition = 'none';

        window.setTimeout(() => {
            path.style.transition = `stroke-dashoffset ${duration}ms cubic-bezier(0.22, 1, 0.36, 1)`;
            path.style.strokeDashoffset = '0';
        }, delay);
    };

    animatePath(iconWrap.querySelector('.success-circle-path'), 520, 20);
    animatePath(iconWrap.querySelector('.success-check-path'), 460, 280);
}

// Celebration animation (performance optimized)
function playCelebration(durationMs = 9000) {
    if (typeof document === 'undefined' || !document.body) return;

    if (cleanupCelebration) {
        cleanupCelebration();
    }

    const canvas = document.createElement('canvas');
    canvas.setAttribute('aria-hidden', 'true');
    Object.assign(canvas.style, {
        position: 'fixed',
        top: '0',
        left: '0',
        width: '100vw',
        height: '100vh',
        pointerEvents: 'none',
        zIndex: '9999'
    });
    document.body.appendChild(canvas);

    const ctx = canvas.getContext('2d');
    if (!ctx) { canvas.remove(); return; }

    const prefersReducedMotion = typeof window.matchMedia === 'function'
        && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    const confetti = [];
    const sparks = [];
    const confettiColors = ['#bc1f1f', '#d84b1f', '#f4b43d', '#f8d46a', '#ff6b6b', '#ffd700', '#ff4444', '#e8c547'];
    const fireworkHues = [0, 8, 15, 28, 42, 50, 340, 350, 355];
    const maxConfetti = prefersReducedMotion ? 40 : 80;
    const maxSparks = prefersReducedMotion ? 30 : 60;
    const endTime = performance.now() + durationMs;
    const DRAG = 0.99;
    const SPARK_DRAG = 0.98;

    let width = 0, height = 0;
    let animationId = 0;
    let fireworkTimer = 0;
    let visibilityHandler = null;
    let lastFrameTs = 0;
    const timeoutIds = [];

    function resizeCanvas() {
        width = window.innerWidth;
        height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
        ctx.setTransform(1, 0, 0, 1, 0, 0);
    }

    function addConfettiPiece(srcX, srcY, angle, speed) {
        if (confetti.length >= maxConfetti) return;
        const life = 3.0 + Math.random() * 2.0;
        confetti.push({
            x: srcX, y: srcY,
            vx: Math.cos(angle) * speed,
            vy: Math.sin(angle) * speed,
            gravity: 55 + Math.random() * 25,
            w: 5 + Math.random() * 7,
            h: 3 + Math.random() * 4,
            rot: Math.random() * 6.28,
            spin: (Math.random() - 0.5) * 5,
            wobble: Math.random() * 6.28,
            wobbleSpd: 2 + Math.random() * 2,
            life, maxLife: life,
            ci: Math.floor(Math.random() * confettiColors.length)
        });
    }

    function burstConfetti(cx, cy, count, baseAngle, spread, speedMin, speedRange) {
        for (let i = 0; i < count; i++) {
            const a = baseAngle + (Math.random() - 0.5) * spread;
            const s = speedMin + Math.random() * speedRange;
            addConfettiPiece(
                cx + (Math.random() - 0.5) * 20,
                cy + (Math.random() - 0.5) * 20,
                a, s
            );
        }
    }

    function addFireworkBurst(x, y) {
        const hue = fireworkHues[Math.floor(Math.random() * fireworkHues.length)];
        const count = Math.min(24, maxSparks - sparks.length);
        if (count <= 0) return;
        for (let i = 0; i < count; i++) {
            const angle = (6.28 * i) / count + (Math.random() - 0.5) * 0.4;
            const speed = 120 + Math.random() * 180;
            const life = 1.0 + Math.random() * 0.7;
            sparks.push({
                x, y, px: x, py: y,
                vx: Math.cos(angle) * speed,
                vy: Math.sin(angle) * speed,
                gravity: 140 + Math.random() * 60,
                life, maxLife: life,
                size: 1.5 + Math.random() * 2,
                hue
            });
        }
    }

    function launchFirework() {
        if (document.hidden || !width || !height) return;
        if (sparks.length >= maxSparks * 0.8) return;
        addFireworkBurst(
            width * (0.15 + Math.random() * 0.7),
            height * (0.08 + Math.random() * 0.3)
        );
    }

    function update(dt) {
        let i = 0;
        while (i < confetti.length) {
            const p = confetti[i];
            p.vx *= DRAG;
            p.vy = Math.min(p.vy + p.gravity * dt, 140);
            p.x += (p.vx + Math.sin(p.wobble) * 10) * dt;
            p.y += p.vy * dt;
            p.rot += p.spin * dt;
            p.wobble += p.wobbleSpd * dt;
            p.life -= dt;
            if (p.life <= 0 || p.y > height + 30) {
                confetti[i] = confetti[confetti.length - 1];
                confetti.pop();
            } else {
                i++;
            }
        }

        i = 0;
        while (i < sparks.length) {
            const p = sparks[i];
            p.px = p.x;
            p.py = p.y;
            p.vx *= SPARK_DRAG;
            p.vy += p.gravity * dt;
            p.x += p.vx * dt;
            p.y += p.vy * dt;
            p.life -= dt;
            if (p.life <= 0 || p.y > height + 20) {
                sparks[i] = sparks[sparks.length - 1];
                sparks.pop();
            } else {
                i++;
            }
        }
    }

    function draw() {
        ctx.clearRect(0, 0, width, height);

        // Batch confetti by color to reduce fillStyle changes
        for (let ci = 0; ci < confettiColors.length; ci++) {
            let hasAny = false;
            for (let j = 0; j < confetti.length; j++) {
                if (confetti[j].ci === ci) { hasAny = true; break; }
            }
            if (!hasAny) continue;

            ctx.fillStyle = confettiColors[ci];
            for (let j = 0; j < confetti.length; j++) {
                const p = confetti[j];
                if (p.ci !== ci) continue;
                const alpha = p.life / p.maxLife;
                if (alpha <= 0.01) continue;

                ctx.globalAlpha = alpha;
                ctx.save();
                ctx.translate(p.x, p.y);
                ctx.rotate(p.rot);
                ctx.fillRect(-p.w * 0.5, -p.h * 0.5, p.w, p.h);
                ctx.restore();
            }
        }

        // Sparks: trail line + core dot (2 draws instead of 3, no glow arc)
        ctx.globalCompositeOperation = 'lighter';
        for (let i = 0; i < sparks.length; i++) {
            const p = sparks[i];
            const alpha = p.life / p.maxLife;
            if (alpha <= 0.02) continue;

            ctx.globalAlpha = alpha * 0.6;
            ctx.beginPath();
            ctx.strokeStyle = 'hsl(' + p.hue + ',95%,62%)';
            ctx.lineWidth = Math.max(1, p.size * 0.7);
            ctx.moveTo(p.px, p.py);
            ctx.lineTo(p.x, p.y);
            ctx.stroke();

            ctx.globalAlpha = alpha * 0.9;
            ctx.beginPath();
            ctx.fillStyle = 'hsl(' + p.hue + ',100%,78%)';
            ctx.arc(p.x, p.y, p.size * 0.8, 0, 6.28);
            ctx.fill();
        }
        ctx.globalCompositeOperation = 'source-over';
        ctx.globalAlpha = 1;
    }

    function tick(ts) {
        if (!lastFrameTs) lastFrameTs = ts;
        const elapsed = ts - lastFrameTs;
        if (elapsed < 16) {
            animationId = window.requestAnimationFrame(tick);
            return;
        }
        lastFrameTs = ts;
        const dt = Math.min(elapsed / 1000, 0.05);
        update(dt);
        draw();

        if (performance.now() < endTime || confetti.length > 0 || sparks.length > 0) {
            animationId = window.requestAnimationFrame(tick);
        } else {
            destroy();
        }
    }

    function destroy() {
        if (fireworkTimer) window.clearInterval(fireworkTimer);
        if (animationId) window.cancelAnimationFrame(animationId);
        timeoutIds.forEach(id => window.clearTimeout(id));
        if (visibilityHandler) document.removeEventListener('visibilitychange', visibilityHandler);
        window.removeEventListener('resize', resizeCanvas);
        canvas.remove();
        cleanupCelebration = null;
    }

    cleanupCelebration = destroy;
    resizeCanvas();
    window.addEventListener('resize', resizeCanvas);

    visibilityHandler = () => { if (document.hidden) destroy(); };
    document.addEventListener('visibilitychange', visibilityHandler);

    // Initial bursts - reduced particle counts
    const rm = prefersReducedMotion ? 0.5 : 1;
    burstConfetti(width * 0.05, height * 0.05, Math.floor(20 * rm), 0.86, 0.7, 130, 100);
    burstConfetti(width * 0.95, height * 0.05, Math.floor(20 * rm), Math.PI - 0.86, 0.7, 130, 100);
    burstConfetti(width * 0.5, height * 0.95, Math.floor(40 * rm), -Math.PI / 2, 0.9, 200, 150);
    burstConfetti(width * 0.05, height * 0.95, Math.floor(15 * rm), -0.74, 0.6, 160, 120);
    burstConfetti(width * 0.95, height * 0.95, Math.floor(15 * rm), -(Math.PI - 0.74), 0.6, 160, 120);

    // Fireworks - fewer and less frequent
    launchFirework();
    timeoutIds.push(window.setTimeout(launchFirework, 300));
    timeoutIds.push(window.setTimeout(launchFirework, 600));
    fireworkTimer = window.setInterval(launchFirework, prefersReducedMotion ? 1500 : 1000);

    animationId = window.requestAnimationFrame(tick);
}

function showToast(message, type = 'info') {
    const toast = document.getElementById('toast');
    if (!toast) return;

    let icon = 'info';
    if (type === 'success') icon = 'check-circle';
    if (type === 'error') icon = 'alert-circle';

    toast.innerHTML = `<i data-lucide="${icon}"></i><span>${message}</span>`;
    toast.className = `toast ${type} show`;

    if (window.lucide) {
        lucide.createIcons();
    }

    setTimeout(() => {
        toast.classList.remove('show');
    }, 3000);
}

// é’å›¨å´²å§ãƒ©î€ƒ
function showStep(stepNumber) {
    document.querySelectorAll('.step').forEach(step => {
        step.classList.remove('active');
    });
    document.getElementById(`step${stepNumber}`).classList.add('active');
}

// æ©æ–¿æ´–å§ãƒ©î€ƒ1
function backToStep1() {
    showStep(1);
    selectedTeamId = null;
}

// å§ãƒ©î€ƒ1: æ¥ å²ƒç˜‰éæˆå´²é®ä½¸è‹Ÿé©å­˜å¸´éæˆå´²
document.getElementById('verifyForm').addEventListener('submit', async (e) => {
    e.preventDefault();

    const email = document.getElementById('email').value.trim();
    const code = document.getElementById('code').value.trim();
    const verifyBtn = document.getElementById('verifyBtn');

    // æ¥ å²ƒç˜‰
    if (!email || !code) {
        showToast('è¯·å¡«å†™å®Œæ•´ä¿¡æ¯', 'error');
        return;
    }

    // æ·‡æ¿†ç“¨é’æ¿åçâ‚¬é™æ©€å™º
    currentEmail = email;
    currentCode = code;

    // ç»‚ä½ºæ•¤é¸å¤æŒ³
    verifyBtn.disabled = true;
    verifyBtn.textContent = 'æ­£åœ¨å…‘æ¢...';

    // é©å­˜å¸´ç’‹å†ªæ•¤éæˆå´²éºãƒ¥å½› (team_id = null ç›ã„§ãšé‘·î„å§©é–«å¤‹å«¨)
    await confirmRedeem(null);

    // é­ãˆ î˜²é¸å¤æŒ³é˜èˆµâ‚¬?(æ¿¡å‚›ç‰ confirmRedeem æ¾¶è¾«è§¦éªèˆµæ¨‰ç»€è½°ç°¡é–¿æ¬’î‡¤æ¶”ç†¸ç—…éå´‡éƒ´é”›å±½æ´œæ¶“è™¹æ•¤é´å³°å½²æµ ãƒ§å£æ©æ–¿æ´–é–²å¶ˆç˜¯)
    verifyBtn.disabled = false;
    verifyBtn.textContent = 'éªŒè¯å…‘æ¢ç ';
});

// å¨“å‰ç…‹Teamé’æ¥„ã€ƒ
function renderTeamsList() {
    const teamsList = document.getElementById('teamsList');
    teamsList.innerHTML = '';

    availableTeams.forEach(team => {
        const teamCard = document.createElement('div');
        teamCard.className = 'team-card';
        teamCard.onclick = () => selectTeam(team.id);

        const planBadge = team.subscription_plan === 'Plus' ? 'badge-plus' : 'badge-pro';

        teamCard.innerHTML = `
            <div class="team-name">${escapeHtml(team.team_name) || 'Team ' + team.id}</div>
            <div class="team-info">
                <div class="team-info-item">
                    <i data-lucide="users" style="width: 14px; height: 14px;"></i>
                    <span>${team.current_members}/${team.max_members} æˆå‘˜</span>
                </div>
                <div class="team-info-item">
                    <span class="team-badge ${planBadge}">${escapeHtml(team.subscription_plan) || 'Plus'}</span>
                </div>
                ${team.expires_at ? `
                <div class="team-info-item">
                    <i data-lucide="calendar" style="width: 14px; height: 14px;"></i>
                    <span>åˆ°æœŸ: ${formatDate(team.expires_at)}</span>
                </div>
                ` : ''}
            </div>
        `;

        teamsList.appendChild(teamCard);
        if (window.lucide) lucide.createIcons();
    });
}

// é–«å¤‹å«¨Team
function selectTeam(teamId) {
    selectedTeamId = teamId;

    // é‡å­˜æŸŠUI
    document.querySelectorAll('.team-card').forEach(card => {
        card.classList.remove('selected');
    });
    event.currentTarget.classList.add('selected');

    // ç»”å¬ªåµ†çº­î†¿î…»éæˆå´²
    confirmRedeem(teamId);
}

// é‘·î„å§©é–«å¤‹å«¨Team
function autoSelectTeam() {
    if (availableTeams.length === 0) {
        showToast('æ²¡æœ‰å¯ç”¨çš„ Team', 'error');
        return;
    }

    // é‘·î„å§©é–«å¤‹å«¨ç»—îƒ¿ç«´æ¶“çŒ…eam(éšåº£î¬æµ¼æ°­å¯œæ©å›¨æ¹¡éƒå •æ£¿éºæ‘ç°­)
    confirmRedeem(null);
}

// çº­î†¿î…»éæˆå´²
async function confirmRedeem(teamId) {
    try {
    // [ANTIGRAVITY MOCK] Simulate Network Request
    await new Promise(r => setTimeout(r, 800));
    console.log("[Mock] Redeem confirmed");
    
    const mockData = {
        success: true,
        message: 'æ¨¡æ‹Ÿå…‘æ¢æˆåŠŸ (æœ¬åœ°æ¼”ç¤º)',
        team_info: {
            team_name: 'GPT Team æ¨¡æ‹Ÿç‰ˆ',
            expires_at: '2026-12-31',
            subscription_plan: 'Pro',
            current_members: 8,
            max_members: 10
        }
    };
    showSuccessResult(mockData);
    return; // Skip real fetch

        const response = await fetch('/redeem/confirm', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                email: currentEmail,
                code: currentCode,
                team_id: teamId
            })
        });

        const data = await response.json();

        if (response.ok && data.success) {
            // éæˆå´²é´æ„¬å§›
            showSuccessResult(data);
        } else {
            // éæˆå´²æ¾¶è¾«è§¦
            showErrorResult(data.error || 'å…‘æ¢å¤±è´¥');
        }
    } catch (error) {
        showErrorResult('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
    }
}

// é„å‰§ãšé´æ„¬å§›ç¼æ’´ç‰
function showSuccessResult(data) {
    const resultContent = document.getElementById('resultContent');
    const teamInfo = data.team_info || {};
    const blessing = getRandomHorseYearBlessing();

    resultContent.innerHTML = `
        <div class="result-success">
            <div class="result-icon success-check-animate">
                <span class="success-halo"></span>
                <svg class="success-checkmark" viewBox="0 0 64 64" aria-hidden="true">
                    <circle class="success-circle-path" cx="32" cy="32" r="25"></circle>
                    <path class="success-check-path" d="M19 33.5L28.5 43L46 24"></path>
                </svg>
            </div>
            <div class="result-title"><i data-lucide="party-popper" style="width:28px;height:28px;vertical-align:-4px;margin-right:4px;color:#bc1f1f;"></i> å…‘æ¢æˆåŠŸ!</div>
            <div class="result-blessing">ğŸŠ ${escapeHtml(blessing)} ğŸŠ</div>
            <div class="result-message">${escapeHtml(data.message) || 'æ‚¨å·²æˆåŠŸåŠ å…¥ Team'}</div>

            <div class="result-details">
                <div class="result-detail-item">
                    <span class="result-detail-label">ğŸ  Team åç§°</span>
                    <span class="result-detail-value">${escapeHtml(teamInfo.team_name) || '-'}</span>
                </div>
                <div class="result-detail-item">
                    <span class="result-detail-label">ğŸ“§ é‚®ç®±åœ°å€</span>
                    <span class="result-detail-value">${escapeHtml(currentEmail)}</span>
                </div>
                ${teamInfo.expires_at ? `
                <div class="result-detail-item">
                    <span class="result-detail-label">ğŸ“… åˆ°æœŸæ—¶é—´</span>
                    <span class="result-detail-value">${formatDate(teamInfo.expires_at)}</span>
                </div>
                ` : ''}
            </div>

            <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 2rem; background: rgba(188,31,31,0.04); padding: 1rem; border-radius: 8px; border: 1px solid rgba(188,31,31,0.1);">
                âœ‰ï¸ é‚€è¯·é‚®ä»¶å·²å‘é€åˆ°æ‚¨çš„é‚®ç®±ï¼Œè¯·æŸ¥æ”¶å¹¶æŒ‰ç…§é‚®ä»¶æŒ‡å¼•æ¥å—é‚€è¯·ã€‚</p>

            <button onclick="location.reload()" class="btn btn-primary">
                <i data-lucide="refresh-cw"></i> å†æ¬¡å…‘æ¢
            </button>
        </div>
    `;
    if (window.lucide) lucide.createIcons();
    window.requestAnimationFrame(() => animateSuccessCheck());

    showStep(3);
    setTimeout(() => {
        document.getElementById('step3').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 300);
    playCelebration(12000);
    // é¢å¤–çš„æ–°å¹´é£˜è½ç‰¹æ•ˆ
    playNewYearOverlay(8000);
}

// é„å‰§ãšé–¿æ¬’î‡¤ç¼æ’´ç‰
function showErrorResult(errorMessage) {
    const resultContent = document.getElementById('resultContent');

    resultContent.innerHTML = `
        <div class="result-error">
            <div class="result-icon"><i data-lucide="x-circle" style="width: 64px; height: 64px; color: var(--danger);"></i></div>
            <div class="result-title">å…‘æ¢å¤±è´¥</div>
            <div class="result-message">${escapeHtml(errorMessage)}</div>

            <div style="display: flex; gap: 1rem; justify-content: center; margin-top: 2rem;">
                <button onclick="backToStep1()" class="btn btn-secondary">
                    <i data-lucide="arrow-left"></i> è¿”å›é‡è¯•
                </button>
                <button onclick="location.reload()" class="btn btn-primary">
                    <i data-lucide="rotate-ccw"></i> é‡æ–°å¼€å§‹</button>
            </div>
        </div>
    `;
    if (window.lucide) lucide.createIcons();

    showStep(3);
    setTimeout(() => {
        document.getElementById('step3').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }, 300);
}

// æ ¼å¼åŒ–æ—¥æœŸ
function formatDate(dateString) {
    if (!dateString) return '-';

    try {
        const date = new Date(dateString);
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    } catch (e) {
        return dateString;
    }
}

/**
 * Physics-based falling particle engine.
 * Each particle has: gravity, mass, air drag, 3D tumble (rotateX/Y/Z),
 * lateral drift coupled to tumble, random initial velocity.
 * Driven by requestAnimationFrame for 60fps smoothness.
 */
const PhysicsFall = (() => {
    const G = 120;          // gravity (px/s^2) â€” softer than real
    const instances = [];

    function createParticle(container, char, opts = {}) {
        const W = container.clientWidth || window.innerWidth;
        const H = container.clientHeight || window.innerHeight;
        const el = document.createElement('span');
        el.className = 'phys-particle';
        el.textContent = char;
        el.style.fontSize = (opts.size || 18) + 'px';
        el.style.contain = 'layout style';
        if (opts.color) el.style.color = opts.color;
        if (opts.textShadow) el.style.textShadow = opts.textShadow;
        if (opts.fontFamily) el.style.fontFamily = opts.fontFamily;
        if (opts.fontWeight) el.style.fontWeight = opts.fontWeight;
        el.style.opacity = '0';
        container.appendChild(el);

        // Random physics properties per particle
        const mass = 0.5 + Math.random() * 1.5;            // 0.5~2.0 â€” lighter = more floaty
        const dragCoeff = 0.015 + Math.random() * 0.025;   // air resistance â€” bigger = slower terminal velocity
        const crossSection = (opts.size || 18) * 0.06;     // larger char = more drag

        return {
            el,
            // Position
            x: opts.x !== undefined ? opts.x : (Math.random() * (W - 30) + 15),
            y: opts.y !== undefined ? opts.y : -(20 + Math.random() * 60),
            // Velocity
            vx: opts.vx !== undefined ? opts.vx : (Math.random() - 0.5) * 30,
            vy: opts.vy !== undefined ? opts.vy : (Math.random() * 15),
            // Physics
            mass,
            drag: dragCoeff,
            cross: crossSection,
            // 3D tumble angles (radians)
            rx: Math.random() * 6.28,
            ry: Math.random() * 6.28,
            rz: Math.random() * 6.28,
            // Tumble angular velocities (rad/s) â€” random per particle
            wrx: (Math.random() - 0.5) * 3.5,
            wry: (Math.random() - 0.5) * 4.0,
            wrz: (Math.random() - 0.5) * 2.0,
            // Tumble â†’ lateral coupling (how much tumble pushes sideways)
            tumbleCoupling: 8 + Math.random() * 20,
            // Alpha
            opacity: opts.opacity !== undefined ? opts.opacity : (0.3 + Math.random() * 0.5),
            fadeIn: true,
            // Bounds
            maxY: H + 80,
            W,
        };
    }

    function stepParticle(p, dt) {
        // Gravity
        const gForce = G * p.mass;

        // Air drag (velocity-dependent, quadratic-ish)
        const speed = Math.sqrt(p.vx * p.vx + p.vy * p.vy) + 0.01;
        const dragMag = p.drag * p.cross * speed;
        const dragX = -p.vx / speed * dragMag;
        const dragY = -p.vy / speed * dragMag;

        // Tumble-induced lateral force: the tumbling creates asymmetric air resistance
        // This gives each particle a unique, non-sinusoidal sideways drift
        const tumbleLateral = Math.sin(p.rx) * Math.cos(p.ry * 0.7) * p.tumbleCoupling;

        // Apply forces  (F = ma â†’ a = F/m)
        const ax = (dragX + tumbleLateral) / p.mass;
        const ay = (gForce + dragY) / p.mass;

        p.vx += ax * dt;
        p.vy += ay * dt;

        // Terminal velocity clamp
        p.vy = Math.min(p.vy, 200);

        p.x += p.vx * dt;
        p.y += p.vy * dt;

        // Update tumble
        p.rx += p.wrx * dt;
        p.ry += p.wry * dt;
        p.rz += p.wrz * dt;

        // Slight tumble damping (air friction on rotation)
        p.wrx *= (1 - 0.1 * dt);
        p.wry *= (1 - 0.1 * dt);
        p.wrz *= (1 - 0.08 * dt);

        // Add tiny random torque impulses for chaos
        if (Math.random() < 0.02) {
            p.wrx += (Math.random() - 0.5) * 1.2;
            p.wry += (Math.random() - 0.5) * 1.2;
        }

        // Wrap horizontally
        if (p.x < -30) p.x = p.W + 20;
        if (p.x > p.W + 30) p.x = -20;

        // Fade in
        let alpha = p.opacity;
        if (p.fadeIn && p.y > 0) p.fadeIn = false;
        if (p.fadeIn) alpha *= Math.max(0, 1 - Math.abs(p.y) / 60);
        // Fade out near bottom
        if (p.y > p.maxY - 120) alpha *= Math.max(0, (p.maxY - p.y) / 120);

        // Apply transform
        p.el.style.opacity = alpha.toFixed(3);
        p.el.style.transform =
            'translate3d(' + p.x.toFixed(1) + 'px,' + p.y.toFixed(1) + 'px,0)' +
            ' rotateX(' + (p.rx * 57.3).toFixed(1) + 'deg)' +
            ' rotateY(' + (p.ry * 57.3).toFixed(1) + 'deg)' +
            ' rotateZ(' + (p.rz * 57.3).toFixed(1) + 'deg)';
    }

    function resetParticle(p) {
        p.y = -(20 + Math.random() * 60);
        p.x = Math.random() * p.W;
        p.vx = (Math.random() - 0.5) * 30;
        p.vy = Math.random() * 10;
        p.wrx = (Math.random() - 0.5) * 3.5;
        p.wry = (Math.random() - 0.5) * 4.0;
        p.wrz = (Math.random() - 0.5) * 2.0;
        p.fadeIn = true;
    }

    /**
     * Start a continuous physics falling loop (for background blossoms).
     * Particles recycle when they fall off screen.
     */
    function startLoop(container, chars, count, sizeRange, opacityRange) {
        const particles = [];
        for (let i = 0; i < count; i++) {
            const char = chars[Math.floor(Math.random() * chars.length)];
            const size = sizeRange[0] + Math.random() * (sizeRange[1] - sizeRange[0]);
            const opacity = opacityRange[0] + Math.random() * (opacityRange[1] - opacityRange[0]);
            const p = createParticle(container, char, {
                size,
                opacity,
                y: -(Math.random() * (container.clientHeight || window.innerHeight) + 40), // stagger start
            });
            // Start scattered across screen height for continuous look
            p.y = Math.random() * (p.maxY + 60) - 60;
            particles.push(p);
        }

        let lastTs = 0;
        let rafId = 0;

        function tick(ts) {
            if (!lastTs) { lastTs = ts; }
            const elapsed = ts - lastTs;
            if (elapsed < 33) { rafId = requestAnimationFrame(tick); return; }
            const dt = Math.min(elapsed / 1000, 0.05);
            lastTs = ts;

            for (let i = 0; i < particles.length; i++) {
                stepParticle(particles[i], dt);
                if (particles[i].y > particles[i].maxY) {
                    resetParticle(particles[i]);
                }
            }
            rafId = requestAnimationFrame(tick);
        }

        rafId = requestAnimationFrame(tick);
        const inst = { stop: () => cancelAnimationFrame(rafId), particles };
        instances.push(inst);
        return inst;
    }

    /**
     * Start a timed physics falling burst (for success overlay).
     * Spawns in waves, particles are removed after falling off screen.
     */
    function startBurst(container, chars, opts = {}) {
        const totalWaves = opts.waves || 5;
        const perWave = opts.perWave || 6;
        const waveInterval = opts.waveInterval || 1200;
        const durationMs = opts.duration || 8000;
        const particles = [];
        let waveCount = 0;
        let lastTs = 0;
        let rafId = 0;
        const timers = [];

        function spawnWave() {
            if (waveCount >= totalWaves) return;
            waveCount++;
            const W = container.clientWidth || window.innerWidth;
            for (let i = 0; i < perWave; i++) {
                const char = chars[Math.floor(Math.random() * chars.length)];
                const size = 22 + Math.random() * 18;
                const pOpts = { size, opacity: 0.7 + Math.random() * 0.3 };
                // Start from random X at top
                pOpts.x = 10 + Math.random() * (W - 40);
                pOpts.y = -(10 + Math.random() * 50);
                pOpts.vx = (Math.random() - 0.5) * 40;
                pOpts.vy = 5 + Math.random() * 20;

                if (char === 'ç¦') {
                    pOpts.color = '#e8a517';
                    pOpts.textShadow = '0 0 10px rgba(244,180,61,0.5), 0 0 20px rgba(244,180,61,0.2)';
                    pOpts.fontFamily = "'Ma Shan Zheng', serif";
                    pOpts.fontWeight = '900';
                }

                particles.push(createParticle(container, char, pOpts));
            }
        }

        function tick(ts) {
            if (!lastTs) lastTs = ts;
            const dt = Math.min((ts - lastTs) / 1000, 0.05);
            lastTs = ts;

            let i = 0;
            while (i < particles.length) {
                stepParticle(particles[i], dt);
                if (particles[i].y > particles[i].maxY + 40) {
                    particles[i].el.remove();
                    particles[i] = particles[particles.length - 1];
                    particles.pop();
                } else {
                    i++;
                }
            }

            if (particles.length > 0 || waveCount < totalWaves) {
                rafId = requestAnimationFrame(tick);
            }
        }

        // Spawn first wave immediately, rest on timers
        spawnWave();
        for (let w = 1; w < totalWaves; w++) {
            timers.push(setTimeout(() => {
                spawnWave();
                // Restart rAF if it stopped
                if (!rafId) rafId = requestAnimationFrame(tick);
            }, w * waveInterval));
        }

        rafId = requestAnimationFrame(tick);

        // Cleanup after duration
        const cleanupTimer = setTimeout(() => {
            cancelAnimationFrame(rafId);
            particles.forEach(p => p.el.remove());
            particles.length = 0;
            container.remove();
        }, durationMs + 5000);
        timers.push(cleanupTimer);

        return {
            stop: () => {
                cancelAnimationFrame(rafId);
                timers.forEach(t => clearTimeout(t));
                particles.forEach(p => p.el.remove());
                container.remove();
            }
        };
    }

    return { createParticle, stepParticle, resetParticle, startLoop, startBurst };
})();

/**
 * Background blossom falling â€” physics driven, continuous loop.
 */
function startPhysicsBlossoms() {
    const container = document.getElementById('fallingBlossoms');
    if (!container) return;
    const chars = ['ğŸŒ¸', 'âœ¿', 'â€', 'ğŸµ', 'ğŸ’®', 'ğŸŒº'];
    const count = Math.min(8, Math.max(4, Math.floor(window.innerWidth / 200)));
    PhysicsFall.startLoop(container, chars, count, [12, 26], [0.2, 0.55]);
}

/**
 * New Year overlay â€” physics-driven burst on success.
 */
function playNewYearOverlay(durationMs = 8000) {
    if (typeof document === 'undefined' || !document.body) return;

    const overlay = document.createElement('div');
    overlay.setAttribute('aria-hidden', 'true');
    overlay.className = 'falling-blossoms'; // reuse the same styles (fixed, overflow:hidden, perspective)
    overlay.style.zIndex = '9998';
    document.body.appendChild(overlay);

    const nyChars = ['ç¦', 'âœ¨', 'ğŸ®', 'ğŸŠ', 'ğŸ’°', 'ğŸ´', 'ğŸ‰', 'ğŸ†', 'ï¿½', 'â­'];
    const perWave = Math.min(8, Math.max(4, Math.floor(window.innerWidth / 120)));

    PhysicsFall.startBurst(overlay, nyChars, {
        waves: 5,
        perWave,
        waveInterval: 1200,
        duration: durationMs
    });
}


/* ============ Warranty (è´¨ä¿) Tab & Logic ============ */

function switchTab(tab) {
    const redeemSteps = ['step1', 'step2', 'step3'];
    const warrantyPanel = document.getElementById('warrantyPanel');
    const tabRedeem = document.getElementById('tab-redeem');
    const tabWarranty = document.getElementById('tab-warranty');
    const switcher = document.querySelector('.tab-switcher');

    if (tab === 'warranty') {
        redeemSteps.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = 'none';
        });
        if (warrantyPanel) warrantyPanel.style.display = 'block';
        tabRedeem.classList.remove('active');
        tabWarranty.classList.add('active');
        if (switcher) switcher.classList.add('warranty-active');
    } else {
        if (warrantyPanel) warrantyPanel.style.display = 'none';
        redeemSteps.forEach(id => {
            const el = document.getElementById(id);
            if (el) el.style.display = '';
        });
        showStep(1);
        tabRedeem.classList.add('active');
        tabWarranty.classList.remove('active');
        if (switcher) switcher.classList.remove('warranty-active');
    }
    if (window.lucide) lucide.createIcons();
}

/* Warranty Query Form */
(function initWarrantyForm() {
    const form = document.getElementById('warrantyForm');
    if (!form) return;

    form.addEventListener('submit', async (e) => {
        e.preventDefault();
        const code = document.getElementById('warrantyCode').value.trim();
        const btn = document.getElementById('warrantyQueryBtn');
        const resultDiv = document.getElementById('warrantyResult');

        if (!code) { showToast('è¯·è¾“å…¥å…‘æ¢ç ', 'error'); return; }

        btn.disabled = true;
        btn.innerHTML = '<i data-lucide="loader" class="spin"></i> æŸ¥è¯¢ä¸­...';
        if (window.lucide) lucide.createIcons();

        try {
            
            // [ANTIGRAVITY MOCK] Simulate Warranty Query
            await new Promise(r => setTimeout(r, 600));
            const mockData = {
                warranty_info: {
                    code: code,
                    remaining_days: 180,
                    used_by_email: 'demo@example.com',
                    used_at: '2025-01-01',
                    warranty_deadline: '2026-06-01',
                    warranty_redeem_count: 0,
                    can_warranty_redeem: true,
                    records: [{
                        email: 'demo@example.com',
                        redeemed_at: '2025-01-01 12:00:00',
                        is_warranty_redeem: false
                    }]
                }
            };
            resultDiv.innerHTML = renderWarrantyInfo(mockData.warranty_info, code);
            btn.disabled = false;
            btn.innerHTML = '<i data-lucide="search"></i> æŸ¥è¯¢è´¨ä¿çŠ¶æ€';
            if (window.lucide) lucide.createIcons();
            return;
/* const res = await fetch('/redeem/warranty/query', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ code })
            }); */

            if (!res.ok) {
                const err = await res.json().catch(() => ({ detail: 'æŸ¥è¯¢å¤±è´¥' }));
                resultDiv.innerHTML = renderWarrantyError(err.detail || 'æŸ¥è¯¢å¤±è´¥');
            } else {
                const data = await res.json();
                resultDiv.innerHTML = renderWarrantyInfo(data.warranty_info, code);
            }
        } catch (err) {
            resultDiv.innerHTML = renderWarrantyError('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•');
        }

        btn.disabled = false;
        btn.innerHTML = '<i data-lucide="search"></i> æŸ¥è¯¢è´¨ä¿çŠ¶æ€';
        if (window.lucide) lucide.createIcons();
    });
})();

function renderWarrantyError(msg) {
    return '<div style="padding:1rem;background:rgba(239,68,68,0.06);border:1px solid rgba(239,68,68,0.18);border-radius:10px;color:#dc2626;font-size:0.92rem;">' +
           '<i data-lucide="alert-circle" style="width:16px;height:16px;vertical-align:middle;margin-right:6px;"></i>' +
           escapeHtml(msg) + '</div>';
}

function renderWarrantyInfo(info, code) {
    const remaining = info.remaining_days;
    let badgeCls = 'wi-badge-ok';
    let badgeText = remaining + ' å¤©';
    if (remaining <= 7) { badgeCls = 'wi-badge-danger'; badgeText = remaining + ' å¤© (å³å°†åˆ°æœŸ)'; }
    else if (remaining <= 14) { badgeCls = 'wi-badge-warn'; badgeText = remaining + ' å¤©'; }

    let html = '<div class="warranty-info-card">';
    html += '<div class="wi-row"><span class="wi-label">å…‘æ¢ç </span><span class="wi-value">' + escapeHtml(info.code) + '</span></div>';
    html += '<div class="wi-row"><span class="wi-label">çŠ¶æ€</span><span class="wi-value"><span class="wi-badge wi-badge-ok">è´¨ä¿ä¸­</span></span></div>';
    html += '<div class="wi-row"><span class="wi-label">ä½¿ç”¨é‚®ç®±</span><span class="wi-value">' + escapeHtml(info.used_by_email || '-') + '</span></div>';
    html += '<div class="wi-row"><span class="wi-label">ä½¿ç”¨æ—¶é—´</span><span class="wi-value">' + escapeHtml(info.used_at) + '</span></div>';
    html += '<div class="wi-row"><span class="wi-label">è´¨ä¿æˆªæ­¢</span><span class="wi-value">' + escapeHtml(info.warranty_deadline) + '</span></div>';
    html += '<div class="wi-row"><span class="wi-label">å‰©ä½™è´¨ä¿</span><span class="wi-value"><span class="wi-badge ' + badgeCls + '">' + badgeText + '</span></span></div>';
    html += '<div class="wi-row"><span class="wi-label">å·²è´¨ä¿æ¬¡æ•°</span><span class="wi-value">' + (info.warranty_redeem_count || 0) + ' æ¬¡</span></div>';
    html += '</div>';

    // Records
    if (info.records && info.records.length) {
        html += '<div class="warranty-records"><h4>ğŸ“‹ ä½¿ç”¨è®°å½•</h4>';
        info.records.forEach(function(r) {
            html += '<div class="wr-item">';
            if (r.is_warranty_redeem) html += '<span class="wr-tag">è´¨ä¿</span>';
            else html += '<span class="wr-tag" style="background:rgba(34,197,94,0.1);color:#16a34a;">é¦–æ¬¡</span>';
            html += '<span>' + escapeHtml(r.email) + '</span>';
            html += '<span style="margin-left:auto;color:#999;font-size:0.8rem;">' + escapeHtml(r.redeemed_at || '') + '</span>';
            html += '</div>';
        });
        html += '</div>';
    }

    // Warranty redeem button
    if (info.can_warranty_redeem) {
        html += '<div style="margin-top:1.2rem;">';
        html += '<p style="font-size:0.85rem;color:#666;margin-bottom:0.8rem;">å¦‚éœ€é‡æ–°åŠ å…¥ Teamï¼Œè¯·è¾“å…¥é‚®ç®±åç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼š</p>';
        html += '<div class="form-group" style="margin-bottom:0.8rem;">';
        html += '<input type="email" id="warrantyEmail" placeholder="è¯·è¾“å…¥é‚®ç®±åœ°å€" class="form-input" required>';
        html += '</div>';
        html += '<button onclick="doWarrantyRedeem(\'' + escapeHtml(code) + '\')" class="btn btn-primary" id="warrantyRedeemBtn" style="width:100%;">';
        html += '<i data-lucide="refresh-cw"></i> è´¨ä¿é‡æ–°å…‘æ¢</button>';
        html += '</div>';
    }

    if (window.lucide) setTimeout(function() { lucide.createIcons(); }, 0);
    return html;
}

async function doWarrantyRedeem(code) {
    const emailInput = document.getElementById('warrantyEmail');
    const btn = document.getElementById('warrantyRedeemBtn');
    const resultDiv = document.getElementById('warrantyResult');

    if (!emailInput || !emailInput.value.trim()) {
        showToast('è¯·è¾“å…¥é‚®ç®±åœ°å€', 'error');
        return;
    }
    const email = emailInput.value.trim();

    btn.disabled = true;
    btn.innerHTML = '<i data-lucide="loader" class="spin"></i> æ­£åœ¨å…‘æ¢...';
    if (window.lucide) lucide.createIcons();

    try {
        const res = await fetch('/redeem/warranty/redeem', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ email, code })
        });

        if (!res.ok) {
            const err = await res.json().catch(() => ({ detail: 'å…‘æ¢å¤±è´¥' }));
            showToast(err.detail || 'è´¨ä¿å…‘æ¢å¤±è´¥', 'error');
            btn.disabled = false;
            btn.innerHTML = '<i data-lucide="refresh-cw"></i> è´¨ä¿é‡æ–°å…‘æ¢';
            if (window.lucide) lucide.createIcons();
            return;
        }

        const data = await res.json();
        showToast(data.message || 'è´¨ä¿å…‘æ¢æˆåŠŸï¼', 'success');

        resultDiv.innerHTML =
            '<div style="padding:1.2rem;background:rgba(34,197,94,0.06);border:1px solid rgba(34,197,94,0.18);border-radius:10px;text-align:center;">' +
            '<div style="font-size:2rem;margin-bottom:0.5rem;">ğŸ‰</div>' +
            '<div style="font-weight:600;color:#16a34a;font-size:1.05rem;margin-bottom:0.4rem;">' + escapeHtml(data.message) + '</div>' +
            '<div style="font-size:0.85rem;color:#666;">ç¬¬ ' + (data.warranty_count || '?') + ' æ¬¡è´¨ä¿å…‘æ¢ Â· è¯·æŸ¥æ”¶é‚®ç®±é‚€è¯·</div>' +
            '</div>';

        // Celebration effects
        if (typeof playCelebration === 'function') playCelebration();
        if (typeof playNewYearOverlay === 'function') playNewYearOverlay();

    } catch (err) {
        showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•', 'error');
        btn.disabled = false;
        btn.innerHTML = '<i data-lucide="refresh-cw"></i> è´¨ä¿é‡æ–°å…‘æ¢';
        if (window.lucide) lucide.createIcons();
    }
}

</script>
    <script>
        if (window.lucide) lucide.createIcons();
        // ç”Ÿæˆç‰©ç†é£˜è½æ¢…èŠ±
        if (typeof startPhysicsBlossoms === 'function') {
            startPhysicsBlossoms();
        }

        // å¯¹è”ç¿»è½¬è½®æ’­
        (function() {
            var coupletSets = [
                { left: 'å¤©å¢å²æœˆäººå¢å¯¿', right: 'æ˜¥æ»¡ä¹¾å¤ç¦æ»¡é—¨', cross: 'æ­è´ºæ–°æ˜¥' },
                { left: 'çˆ†ç«¹å£°ä¸­è¾æ—§å²', right: 'æ¢…èŠ±é¦™é‡ŒæŠ¥æ–°æ˜¥', cross: 'ä¸‡è±¡æ›´æ–°' },
                { left: 'æ˜¥å›å¤§åœ°åƒå±±ç§€', right: 'æ—¥æš–ç¥å·ä¸‡ç‰©è£', cross: 'æ˜¥æ„ç›ç„¶' },
                { left: 'å’Œé¡ºä¸€é—¨æœ‰ç™¾ç¦', right: 'å¹³å®‰äºŒå­—å€¼åƒé‡‘', cross: 'ä¸‡äº‹å¦‚æ„' },
                { left: 'ä¸€å¹´å››å­£æ˜¥å¸¸åœ¨', right: 'ä¸‡ç´«åƒçº¢æ°¸å¼€èŠ±', cross: 'å–œè¿æ–°æ˜¥' },
                { left: 'æ˜¥é£åŒ–é›¨å±±æ²³ç¾', right: 'æ”¿ç­–å½’å¿ƒåŸä¹¡æ¬¢', cross: 'å›½æ³°æ°‘å®‰' },
                { left: 'ä¸€å¸†é£é¡ºå¹´å¹´å¥½', right: 'ä¸‡äº‹å¦‚æ„æ­¥æ­¥é«˜', cross: 'å‰æ˜Ÿé«˜ç…§' },
                { left: 'ç™¾ä¸–å²æœˆå½“ä»£å¥½', right: 'åƒå¤æ±Ÿå±±ä»Šæœæ–°', cross: 'ä¸‡è±¡æ›´æ–°' },
                { left: 'å–œå±…å®åœ°åƒå¹´æ—º', right: 'ç¦ç…§å®¶é—¨ä¸‡äº‹å…´', cross: 'å–œè¿æ–°æ˜¥' },
                { left: 'ä¸€å¹´å››å­£è¡Œå¥½è¿', right: 'å…«æ–¹è´¢å®è¿›å®¶é—¨', cross: 'å®¶å’Œä¸šå…´' },
                { left: 'ç»¿ç«¹åˆ«å…¶ä¸‰åˆ†æ™¯', right: 'çº¢æ¢…æ­£æŠ¥ä¸‡å®¶æ˜¥', cross: 'æ˜¥å›å¤§åœ°' },
                { left: 'å¹´å¹´é¡ºæ™¯åˆ™æºå¹¿', right: 'å²å²å¹³å®‰ç¦å¯¿å¤š', cross: 'å‰ç¥¥å¦‚æ„' },
                { left: 'äº”æ›´åˆ†ä¸¤å¹´å¹´å¹´ç§°å¿ƒ', right: 'ä¸€å¤œè¿ä¸¤å²å²å²å¦‚æ„', cross: 'æ­è´ºæ–°ç¦§' },
                { left: 'å¤§åœ°æµé‡‘ä¸‡äº‹é€š', right: 'å†¬å»æ˜¥æ¥ä¸‡è±¡æ–°', cross: 'æ¬¢åº¦æ˜¥èŠ‚' },
                { left: 'æ—¥å‡ºæ±ŸèŠ±çº¢èƒœç«', right: 'æ˜¥æ¥æ±Ÿæ°´ç»¿å¦‚è“', cross: 'é¸Ÿè¯­èŠ±é¦™' },
                { left: 'é£å’Œæ—¥ä¸½æ˜¥å¸¸é©»', right: 'äººå¯¿å¹´ä¸°ç¦æ°¸å­˜', cross: 'ç¦æ˜Ÿé«˜ç…§' },
                { left: 'æ˜¥é£å…¥å–œè´¢å…¥æˆ·', right: 'å²æœˆæ›´æ–°ç¦æ»¡é—¨', cross: 'æ–°æ˜¥å¤§å‰' },
                { left: 'äº‹äº‹å¦‚æ„å¤§å‰ç¥¥', right: 'å®¶å®¶é¡ºå¿ƒæ°¸å®‰åº·', cross: 'å››å­£å…´éš†' },
                { left: 'è¿æ–°æ˜¥æ±Ÿå±±é”¦ç»£', right: 'è¾æ—§å²äº‹æ³°è¾‰ç…Œ', cross: 'æ˜¥æ„ç›ç„¶' },
                { left: 'æ—§å²åˆæ·»å‡ ä¸ªå–œ', right: 'æ–°å¹´æ›´ä¸Šä¸€å±‚æ¥¼', cross: 'è¾æ—§è¿æ–°' },
                { left: 'ä¸œé£åŒ–é›¨å±±å±±ç¿ ', right: 'æ”¿ç­–å½’å¿ƒå¤„å¤„æ˜¥', cross: 'æ˜¥é£åŒ–é›¨' },
                { left: 'å®¶è¿‡å°åº·æ¬¢ä¹æ—¥', right: 'æ˜¥å›å¤§åœ°è‰³é˜³å¤©', cross: 'äººå¯¿å¹´ä¸°' },
                { left: 'å¤šåŠ³å¤šå¾—äººäººä¹', right: 'ä¸°äº§ä¸°æ”¶å²å²ç”œ', cross: 'å›½å¼ºæ°‘å¯Œ' },
                { left: 'å£®ä¸½å±±æ²³å¤šå¼‚å½©', right: 'æ–‡æ˜å›½åº¦éé«˜é£', cross: 'å±±æ²³å£®ä¸½' },
                { left: 'è´¢è¿äº¨é€šæ­¥æ­¥é«˜', right: 'æ—¥å­çº¢ç«è…¾è…¾èµ·', cross: 'è¿æ˜¥æ¥ç¦' },
                { left: 'ç¦æ—ºè´¢æ—ºè¿æ°”æ—º', right: 'å®¶å…´äººå…´äº‹ä¸šå…´', cross: 'ä¸‡äº‹äº¨é€š' },
                { left: 'å¤§åœ°æ­Œå”¤å½©äº‘è¿½æœˆ', right: 'é“¶æ²³æ›²å”±é”¦ç»£å±±æ²³', cross: 'é”¦ç»£å‰ç¨‹' },
                { left: 'ä¸€é—¨ç‘æ°”å¾¡é£é£ç¿”', right: 'æ»¡é™¢ç¥¥å…‰é€æ—¥è…¾è¾‰', cross: 'ç¥¥å…‰æ™®ç…§' },
                { left: 'ä¸œé£é€æš–æ–‡æ˜ç¬¬å®…', right: 'å–œæ°”ä¸´é—¨å’Œç¦äººå®¶', cross: 'é˜–å®¶æ¬¢ä¹' },
                { left: 'å²é€šç››ä¸–å®¶å®¶å¯Œ', right: 'äººé‡å¹´åä¸ªä¸ªæ¬¢', cross: 'çš†å¤§æ¬¢å–œ' },
                { left: 'ä¸¹å‡¤å‘ˆç¥¥é¾™çŒ®ç‘', right: 'çº¢æ¡ƒè´ºå²æè¿æ˜¥', cross: 'ç¦æ»¡äººé—´' },
                { left: 'äº”æ¹–å››æµ·çš†æ˜¥è‰²', right: 'ä¸‡æ°´åƒå±±å°½å¾—è¾‰', cross: 'ä¸‡è±¡æ›´æ–°' },
                { left: 'é›ªé‡Œæ±Ÿå±±ç¾å¦‚ç”»', right: 'èŠ±é—´å²æœˆç”œä¼¼èœœ', cross: 'ç¾æ»¡å¹¸ç¦' },
                { left: 'èŠ±å¼€å¯Œè´µå®¶å®¶ä¹', right: 'ç¯ç…§å‰ç¥¥å²å²æ¬¢', cross: 'èŠ±å¥½æœˆåœ†' },
                { left: 'è¿å–œè¿æ˜¥è¿å¯Œè´µ', right: 'æ¥è´¢æ¥ç¦æ¥å¹³å®‰', cross: 'å–œæ°”ç›ˆé—¨' },
                { left: 'åˆ›å¤§ä¸šåƒç§‹æ˜Œç››', right: 'å±•å®å›¾å†å°±è¾‰ç…Œ', cross: 'å¤§å±•é¸¿å›¾' },
                { left: 'ä¸€å¹´å¥½è¿éšæ˜¥åˆ°', right: 'å››å­£å½©äº‘æ»šæ»šæ¥', cross: 'ä¸‡äº‹èƒœæ„' },
                { left: 'ä¸¹å‡¤å‘ˆç¥¥é¾™çŒ®ç‘', right: 'ç´«æ°”ä¸œæ¥ç¦æ»¡å ‚', cross: 'é¾™å‡¤å‘ˆç¥¥' },
                { left: 'åº†ä½³èŠ‚åˆå®¶å›¢èš', right: 'è¿æ–°æ˜¥æ»¡é™¢ç”Ÿè¾‰', cross: 'åˆå®¶æ¬¢ä¹' },
                { left: 'æ˜¥ä¸´å¤§åœ°ç™¾èŠ±è‰³', right: 'èŠ‚è‡³äººé—´ä¸‡è±¡æ–°', cross: 'æ˜¥æ»¡äººé—´' },
                { left: 'ä¸‡é‡Œæ˜¥é£å‚¬æ¡ƒæ', right: 'ä¸€è…”çƒ­è¡€è‚²æ–°äºº', cross: 'æ˜¥é£åŒ–é›¨' },
                { left: 'é»„èºé¸£ç¿ æŸ³é£èˆ', right: 'ç´«ç‡•å‰ªæ˜¥é£é€æš–', cross: 'èºæ­Œç‡•èˆ' },
                { left: 'å¥½æ—¶ä»£å¥½é£å…‰å¥½è¿', right: 'æ–°ç¤¾ä¼šæ–°æ°”è±¡æ–°æ˜¥', cross: 'æ—¥æ–°æœˆå¼‚' },
                { left: 'å¤„å¤„æ˜¥å…‰å¥½å¹´å¹´å…¥ç”»', right: 'å®¶å®¶å–œæ°”æµ“å²å²å¹³å®‰', cross: 'å››æµ·åŒæ˜¥' },
                { left: 'è´¢æºæ»šæ»šéšæ˜¥åˆ°', right: 'å–œæ°”æ´‹æ´‹ä¼´ç¦æ¥', cross: 'è´¢æºå¹¿è¿›' },
                { left: 'çº¢æ¢…å«è‹å‚²å†¬é›ª', right: 'ç»¿æŸ³åçµ®è¿æ–°æ˜¥', cross: 'æ¬¢åº¦æ˜¥èŠ‚' },
                { left: 'ç™¾èŠ±é½æ”¾æ˜¥å…‰å¥½', right: 'ä¸‡é©¬å¥”è…¾æ°”è±¡æ–°', cross: 'é©¬åˆ°æˆåŠŸ' },
                { left: 'æ—¥æ—¥è´¢æºé¡ºæ„æ¥', right: 'å¹´å¹´ç¦ç¦„éšæ˜¥åˆ°', cross: 'æ–°æ˜¥å¿«ä¹' },
                { left: 'ç‘æ°”ç›ˆé—¨å¹¸ç¦å®¶', right: 'ç¥¥å…‰æ™®ç…§å¦‚æ„å¹´', cross: 'ç‘é›ªä¸°å¹´' },
                { left: 'å¼ ç¯ç»“å½©è¿æ–°æ˜¥', right: 'æ¬¢å¤©å–œåœ°åº¦ä½³èŠ‚', cross: 'æ™®å¤©åŒåº†' }
            ];
            var idx = 0;
            var leftWrap = document.querySelector('.couplet-wrapper.couplet-left');
            var rightWrap = document.querySelector('.couplet-wrapper.couplet-right');
            var crossWrap = document.querySelector('.crossbeam-wrapper');
            if (!leftWrap || !rightWrap || !crossWrap) return;

            var leftFront = leftWrap.querySelector('.couplet-front');
            var leftBack = leftWrap.querySelector('.couplet-back');
            var rightFront = rightWrap.querySelector('.couplet-front');
            var rightBack = rightWrap.querySelector('.couplet-back');
            var crossFront = crossWrap.querySelector('.crossbeam-front');
            var crossBack = crossWrap.querySelector('.crossbeam-back');

            setInterval(function() {
                var nextIdx = (idx + 1) % coupletSets.length;
                var nextSet = coupletSets[nextIdx];
                var isFlipped = leftWrap.classList.contains('flipped');

                if (isFlipped) {
                    leftFront.textContent = nextSet.left;
                    rightFront.textContent = nextSet.right;
                    crossFront.textContent = nextSet.cross;
                } else {
                    leftBack.textContent = nextSet.left;
                    rightBack.textContent = nextSet.right;
                    crossBack.textContent = nextSet.cross;
                }

                leftWrap.classList.toggle('flipped');
                rightWrap.classList.toggle('flipped');
                crossWrap.classList.toggle('flipped');
                idx = nextIdx;
            }, 5000);
        })();
    </script>

</body></html>